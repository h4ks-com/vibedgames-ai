<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>64-Word Cultures + Wing Commander 4D</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
  body{margin:16px;background:#0b1020;color:#e6eef8}
  header{display:flex;align-items:center;gap:12px;margin-bottom:14px}
  h1{font-size:18px;margin:0}
  .controls{margin-left:auto;display:flex;gap:8px}
  button{background:#1d2a44;color:#e6eef8;border:0;padding:8px 10px;border-radius:8px;cursor:pointer}
  button.secondary{background:#25354f}
  .wrap{display:grid;grid-template-columns:1fr 420px;gap:16px}
  .cultures{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;align-content:start}
  .card{background:linear-gradient(180deg,#122033,#0b1220);border:1px solid rgba(255,255,255,0.03);padding:10px;border-radius:10px;min-height:160px}
  .card-head{display:flex;align-items:center;gap:8px;margin-bottom:8px}
  .emoji{font-size:26px}
  .culture-title{font-weight:600}
  .small{font-size:12px;color:#94a6c6}
  .words{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;font-family:monospace;font-size:11px;line-height:1.1}
  .word{background:rgba(255,255,255,0.02);padding:6px;border-radius:6px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
  .side{background:linear-gradient(180deg,#07121c,#061017);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
  .panel{margin-bottom:12px}
  .panel h2{font-size:14px;margin:0 0 8px 0}
  .mission{background:#071827;padding:10px;border-radius:8px;font-family:monospace;font-size:13px;line-height:1.3;color:#cfe8ff}
  footer{margin-top:18px;color:#94a6c6;font-size:12px}
  .muted{color:#7290b4;font-size:12px}
  .mini{font-size:12px;padding:6px 8px}
  .culture-actions{margin-left:auto;display:flex;gap:6px;align-items:center}
  .regen{background:#2b5a84}
  .regen:hover{filter:brightness(1.05)}
  .all-btn{background:#2f8bd0;padding:10px 12px;border-radius:10px}
  .grid-full{grid-column:1/-1}
  @media(max-width:1100px){.wrap{grid-template-columns:1fr;}.cultures{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
<header>
  <h1>64 Cultures — each is 64 words (64 chars each)</h1>
  <div class="controls">
    <button class="all-btn" id="regenAllBtn">Regenerate All Cultures</button>
    <button id="regenPoolBtn" class="secondary">Regenerate Word Pool</button>
  </div>
</header>

<div class="wrap">
  <div>
    <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px">
      <div class="muted">Pool: <span id="poolCount">0</span> words (64 chars each)</div>
      <div class="muted">Cultures: 64</div>
    </div>

    <div class="cultures" id="culturesContainer">
      <!-- 64 culture cards inserted here -->
    </div>
  </div>

  <aside class="side">
    <div class="panel">
      <h2>Wing Commander — but with 4 spatial dimensions</h2>
      <div class="mission" id="missionText">
        <!-- Generated mission text -->
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="regenMission" class="mini">Regenerate Mission</button>
        <button id="expandMission" class="mini secondary">Expand Brief</button>
      </div>
    </div>

    <div class="panel">
      <h2>Pool Preview (first 12)</h2>
      <div id="poolPreview" style="font-family:monospace;font-size:12px;color:#cfe8ff;line-height:1.2"></div>
    </div>

    <div>
      <h2>Notes</h2>
      <div class="small">Each culture card has an animal emoji and a button to regenerate its 64-word lexicon from the pool. Use the top controls to regenerate everything at once.</div>
    </div>
  </aside>
</div>

<footer>
  Tip: click a culture's regen to shuffle its words. The pool contains 1000 compound words constructed from English words joined by '-' or '.' and exactly 64 characters long.
</footer>

<script>
// curated English word list: diverse lengths 1..12
const WORD_LIST = [
"a","I","am","be","to","of","in","on","it","as","at","by","an","or","so",
"time","person","year","way","day","thing","man","world","life","hand","part","child","eye","place","work","week","case",
"point","government","company","number","group","problem","fact","home","water","room","mother","area","money",
"story","study","book","night","point","company","system","program","question","woman","night","school","state",
"family","student","group","country","city","service","market","company","result","process","policy","period","figure","model",
"power","force","order","sense","term","unit","line","idea","plan","role","rate","level","stage","method",
"science","art","music","heart","mind","reason","space","field","nature","structure","machine","engine","network",
"signal","domain","vector","matrix","tensor","sphere","orbit","angle","slice","plane","axis","basis","curve",
"bridge","tunnel","station","harbor","island","valley","mountain","forest","desert","ocean","river","shore",
"weapon","armor","shield","engineer","pilot","captain","commander","lieutenant","brigade","squadron","fleet",
"pilotage","navigation","tactics","strategy","mission","combat","engage","retreat","thrust","pursuit",
"alliance","covenant","tribe","clan","colony","outpost","settlement","habitat","sanctum","citadel",
"harbinger","vanguard","sentinel","guardian","watcher","ranger","pathfinder","voyager","explorer","pioneer",
"artisan","merchant","trader","smith","weaver","scribe","keeper","steward","herald","scribe",
"echo","whisper","shout","rumor","signal","beacon","flare","pulse","ripple","wave",
"flank","wing","squad","wingman","skirmish","battle","engagement","assault","raid","strike",
"engine","reactor","core","matrix","module","unit","node","hub","array","cluster",
"cipher","protocol","cache","buffer","stream","packet","packetize","encode","decode","process",
"glyph","rune","sigil","icon","token","glyphic","ledger","archive","codex","script",
"bridgehead","foothold","stronghold","sanctuary","refuge","asylum","bastion","bulwark","rampart","redoubt",
"harvest","forage","gather","sow","reap","forge","craft","build","construct","design",
"mirror","lens","prism","facet","facetize","facetole","spectrum","palette","canvas","grain",
"charter","edict","decree","edictal","mandate","statute","covenant","compact","pact","treaty",
"alloy","compound","element","molecule","crystal","quartz","metal","plasma","liquid","vapor",
"ember","flame","spark","emberwood","grease","oil","tar","resin","glaze","veneer",
"orbitals","hyperspace","continuum","manifold","dimension","hyperplane","topology","geometry","metric","tensorial",
"vectorial","rotor","gyro","spin","torsion","strain","stress","flux","gradient","divergence",
"pilotless","autopilot","manned","crewed","drone","android","cyborg","organic","veneer","synth",
"lattice","gridlock","networked","synapse","axon","neuron","cortex","kernel","pulsewave","oscillator",
"parallax","perspective","horizon","zenith","nadir","cadence","tempo","rhythm","beat","measure",
"chronicle","annals","archive","logbook","manifest","registry","ledger","rollcall","index","catalog",
"harboring","anchorage","mooring","berth","dockside","slipway","dockyard","shipyard","quay","wharf",
"compass","bearing","heading","course","vectoring","attitude","yaw","pitch","roll","trim",
"magnitude","scalar","ordinal","cardinal","binary","ternary","quaternary","quintet","septet","octet",
"vertex","edge","face","cell","polytope","hypercube","tesseract","manifold","simplex","network",
"starlight","sunrise","sunset","dawn","dusk","eclipse","umbra","penumbra","radiant","luminous",
"kiln","forgefire","anvil","hammer","chisel","lathe","mill","press","ironside","smithy",
"harbinger","omen","portent","augury","oracle","seer","prophet","vision","dream","revelation",
"merchantile","commodore","admiral","captaincy","ensign","flagship","corvette","frigate","destroyer","cruiser",
"patrol","escort","relay","beaconry","waypoint","gate","portal","threshold","passage","corridor",
"biosphere","atmosphere","thermosphere","ionosphere","stratosphere","troposphere","cryosphere","lithosphere","mantle","core"
];

// Animal emoji list (64 unique-ish)
const ANIMALS = ["🦅","🐺","🦁","🐉","🦊","🦄","🐘","🐬","🐳","🦈","🐊","🦖","🦕","🦅","🦢","🦉",
"🐓","🦚","🦜","🦩","🦔","🦝","🐿️","🦥","🐻","🐨","🐼","🐯","🐵","🦍","🐸","🐙",
"🦑","🦐","🦞","🦋","🐝","🐞","🪲","🐜","🪰","🪱","🐢","🦎","🐍","🐉","🦦","🦇",
"🐅","🐂","🐄","🐎","🐖","🐐","🐑","🦙","🦃","🕊️","🦆","🦢","🪿","🐧","🐦","🐤"];

// Precompute lengths map
const words = WORD_LIST.map(w => w.replace(/[^a-zA-Z]/g,'')).filter(Boolean);
const lenMap = {};
let minLen = Infinity, maxLen = 0;
for (const w of words) {
  const l = w.length;
  if (!lenMap[l]) lenMap[l]=[];
  lenMap[l].push(w);
  if (l < minLen) minLen = l;
  if (l > maxLen) maxLen = l;
}

const POOL_SIZE = 1000;
let pool = [];
let cultures = []; // array of 64 cultures, each is array of 64 words

function randomChoice(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

// create a single 64-char compound word by selecting k words whose lengths + (k-1 separators) == 64
function makeCompound() {
  const maxAttempts = 200;
  for (let attempt=0; attempt<maxAttempts; attempt++){
    // choose k such that target = 64-(k-1) is between k*minLen and k*maxLen
    const kCandidates = [];
    for (let k=2;k<=12;k++){
      const target = 64-(k-1);
      if (k*minLen <= target && k*maxLen >= target) kCandidates.push(k);
    }
    if (!kCandidates.length) return null;
    const k = randomChoice(kCandidates);
    const target = 64 - (k-1);
    const chosen = [];
    let sum=0;
    let ok=true;
    for (let i=0;i<k;i++){
      const remaining = k - i;
      const remainingMin = remaining*minLen;
      const remainingMax = remaining*maxLen;
      const need = target - sum;
      // pick length for this word: must satisfy minLen <= len <= maxLen and also (need - (remaining-1)*maxLen) <= len <= (need - (remaining-1)*minLen)
      const lo = Math.max(minLen, need - (remaining-1)*maxLen);
      const hi = Math.min(maxLen, need - (remaining-1)*minLen);
      if (lo>hi){ ok=false; break; }
      // choose a random len between lo and hi that has words
      const possibleLens = [];
      for (let L=lo;L<=hi;L++) if (lenMap[L] && lenMap[L].length>0) possibleLens.push(L);
      if (!possibleLens.length){ ok=false; break; }
      const chosenLen = randomChoice(possibleLens);
      const w = randomChoice(lenMap[chosenLen]);
      chosen.push(w);
      sum += chosenLen;
    }
    if (!ok) continue;
    if (sum !== target) continue;
    // join with random separators '.' or '-'
    let out = chosen[0];
    for (let i=1;i<chosen.length;i++){
      out += (Math.random()<0.5 ? '-' : '.') + chosen[i];
    }
    // randomize case across parts
    out = out.split('').map(ch => {
      if (/[a-zA-Z]/.test(ch)) return Math.random()<0.12 ? ch.toUpperCase() : ch.toLowerCase();
      return ch;
    }).join('');
    if (out.length===64 && /^[A-Za-z\-.]+$/.test(out)) return out;
  }
  return null;
}

function buildPool() {
  pool = [];
  const set = new Set();
  let guard=0;
  while (pool.length < POOL_SIZE && guard < POOL_SIZE*10) {
    guard++;
    const c = makeCompound();
    if (!c) continue;
    if (!set.has(c)){
      set.add(c);
      pool.push(c);
    }
  }
  // fallback: if not enough unique, allow duplicates by slightly tweaking case
  if (pool.length < POOL_SIZE) {
    while (pool.length < POOL_SIZE) {
      const c = makeCompound();
      if (!c) break;
      pool.push(c);
    }
  }
  document.getElementById('poolCount').textContent = pool.length;
  updatePoolPreview();
}

function updatePoolPreview(){
  const preview = pool.slice(0,12).map((w,i)=>`${String(i+1).padStart(2,' ')}: ${w}`).join('\n');
  document.getElementById('poolPreview').textContent = preview;
}

function makeCultureWords() {
  // pick 64 words randomly from pool (without replacement if possible)
  const picks = [];
  const used = new Set();
  const poolLen = pool.length;
  for (let i=0;i<64;i++){
    if (used.size >= poolLen) {
      // reuse allowed
      picks.push(randomChoice(pool));
    } else {
      // sample without replacement
      let idx = Math.floor(Math.random()*(poolLen));
      let tries=0;
      while (used.has(idx) && tries<20){ idx = Math.floor(Math.random()*(poolLen)); tries++; }
      if (used.has(idx)){
        // fallback linear scan
        for (let j=0;j<poolLen;j++) if (!used.has(j)){ idx=j; break;}
      }
      used.add(idx);
      picks.push(pool[idx]);
    }
  }
  return picks;
}

function buildCultures() {
  cultures = [];
  for (let i=0;i<64;i++){
    cultures.push({
      id: i,
      emoji: ANIMALS[i % ANIMALS.length],
      words: makeCultureWords()
    });
  }
  renderCultures();
}

function renderCultures(){
  const container = document.getElementById('culturesContainer');
  container.innerHTML = '';
  cultures.forEach((c, idx) => {
    const card = document.createElement('div');
    card.className = 'card';
    const head = document.createElement('div');
    head.className = 'card-head';
    const emoji = document.createElement('div');
    emoji.className = 'emoji';
    emoji.textContent = c.emoji;
    const title = document.createElement('div');
    title.innerHTML = `<div class="culture-title">Culture ${idx+1}</div><div class="small">64 lexemes · ${c.words.length} entries</div>`;
    const actions = document.createElement('div');
    actions.className = 'culture-actions';
    const regenBtn = document.createElement('button');
    regenBtn.className = 'mini regen';
    regenBtn.textContent = 'Regenerate';
    regenBtn.onclick = () => {
      cultures[idx].words = makeCultureWords();
      renderCultures();
    };
    actions.appendChild(regenBtn);
    head.appendChild(emoji);
    head.appendChild(title);
    head.appendChild(actions);
    const wordsGrid = document.createElement('div');
    wordsGrid.className = 'words';
    c.words.forEach(w => {
      const wdiv = document.createElement('div');
      wdiv.className = 'word';
      wdiv.title = w;
      wdiv.textContent = w;
      wordsGrid.appendChild(wdiv);
    });
    card.appendChild(head);
    card.appendChild(wordsGrid);
    container.appendChild(card);
  });
}

// Wing Commander 4D generator
function genMission(short=false) {
  // create evocative brief imagining 4 spatial dimensions
  const adjectives = ["four-dimensional","tesseractic","hyperplane","non-Euclidean","orthogonal","rotational","folded","hyperspatial"];
  const verbs = ["navigate","engage","maneuver","outflank","stabilize","orient","fold","unravel","project","anchor"];
  const threats = ["anomalous rifts","hyperdimensional raiders","phase-shear swarms","tesseract mines","time-delocalized fighters","chorus of echoes"];
  const objectives = ["secure a junction","hold the gate","escort the convoy through a fold","intercept a warp vector","close a dimensional breach","establish a stable crossing"];
  const constraints = ["gravitic misalignment","four-axis inertia","mirror-rotational drift","parallax inversion","phase entanglement"];
  const reward = ["strategic foothold","salvage of exotic matter","data on hypergeometry","safe passage for the fleet"];

  const a = randomChoice(adjectives);
  const v = randomChoice(verbs);
  const t = randomChoice(threats);
  const o = randomChoice(objectives);
  const c = randomChoice(constraints);
  const r = randomChoice(reward);

  const pilotRole = randomChoice(["Wing Commander","Chief Shuttle","Vector Captain","Hyperwing Lead","Dimensional Ace"]);
  const craft = randomChoice(["tesseract interceptor","rotor-winger","hypercube corvette","phase-torpedo frigate"]);
  const numWings = randInt(2,6);

  let brief = `${pilotRole} — Mission Brief\n\n`;
  brief += `The theater: a ${a} corridor where conventional geometry fails. Enemy activity: ${t}. Your task: ${o}.\n\n`;
  brief += `You will command ${numWings} wings of ${craft} to ${v} across four orthogonal axes. Expect ${c}; standard tactics will twist into new vectors — line-of-sight becomes a volume. Bands and flanks may appear above, beside, and through what would previously have been 'behind'.\n\n`;
  brief += `Rules of engagement: maintain vector lock on the anchor node; avoid mirror-rotational locks which will convert angular momentum into hyper-translation. Use phase anchors to localize friendlies and prevent drift into adjacent folds.\n\n`;
  if (!short) {
    brief += `Tactical note: attacks that 'miss' along three familiar axes can still strike along the fourth. Harassment runs should approach via a skewed trajectory: strike across two axes, pivot across the third, and exit along the fourth. Boarding and capture require synchronization of vector phases; any desynchronization leaves boarding parties stranded in a neighboring hyperplane.\n\n`;
    brief += `If successful, you secure ${r} and deny the enemy a staging locus. Failure risks detachment and permanent loss into adjacent manifolds. Good hunting — reorient, adapt, and dominate the folds.`;
  } else {
    brief += `Success yields ${r}. Adapt to the fourth axis; conventional instincts will betray you.`;
  }
  return brief;
}

// UI wiring
document.getElementById('regenAllBtn').addEventListener('click', ()=>{
  buildPool();
  buildCultures();
});
document.getElementById('regenPoolBtn').addEventListener('click', ()=>{
  buildPool();
});
document.getElementById('regenMission').addEventListener('click', ()=>{
  document.getElementById('missionText').textContent = genMission(false);
});
document.getElementById('expandMission').addEventListener('click', ()=>{
  document.getElementById('missionText').textContent = genMission(false);
});

// initial build
buildPool();
buildCultures();
document.getElementById('missionText').textContent = genMission(true);

</script>
</body>
</html>