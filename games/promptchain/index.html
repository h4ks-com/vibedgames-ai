<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Blockchain NFT Prompts with Perlin Noise</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            position: relative;
        }
        h1 {
            text-align: center;
        }
        #promptForm {
            margin-bottom: 20px;
        }
        #promptList {
            margin-top: 20px;
        }
        .prompt {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .prompt h3 {
            margin: 0;
        }
        #graphContainer {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            height: 300px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 10px;
        }
        #graph {
            width: 100%;
            height: 100%;
        }
        #inventory {
            margin-top: 20px;
        }
        #buybackLog {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 10px;
        }
    </style>
</head>
<body>

<h1>Dynamic Blockchain NFT Prompts with Perlin Noise</h1>
<div>
    <label for="beans">Your Beans: </label>
    <span id="beans">100</span>
</div>
<div>
    <label for="generalFund">General Fund: </label>
    <span id="generalFund">0</span>
</div>

<div id="promptForm">
    <input type="text" id="promptInput" placeholder="Enter your prompt" />
    <button id="addPromptBtn">Add Prompt (10 Beans)</button>
</div>

<div id="promptList"></div>
<div id="inventory">
    <h2>Your Inventory</h2>
    <ul id="inventoryList"></ul>
</div>
<div id="graphContainer">
    <canvas id="graph"></canvas>
</div>
<div id="buybackLog">
    <h2>Bank Buyback Log</h2>
    <ul id="buybackList"></ul>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
<script>
    let userBeans = 100;
    let generalFund = 0;
    const prompts = [];
    const inventory = [];
    const ctx = document.getElementById('graph').getContext('2d');
    let chart;
    const noise = new SimplexNoise();
    let noiseOffset = 0;

    document.getElementById('addPromptBtn').addEventListener('click', addPrompt);
    document.getElementById('promptInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            addPrompt();
        }
    });

    function addPrompt() {
        const promptText = document.getElementById('promptInput').value;
        if (promptText && userBeans >= 10) {
            userBeans -= 10;
            document.getElementById('beans').innerText = userBeans;
            const prompt = { text: promptText, value: 10, votes: 0 };
            prompts.push(prompt);
            document.getElementById('promptInput').value = '';
            updatePromptList();
        } else {
            alert('You need more beans or enter a valid prompt!');
        }
    }

    function updatePromptList() {
        const promptList = document.getElementById('promptList');
        promptList.innerHTML = '';
        prompts.forEach((prompt, index) => {
            const promptDiv = document.createElement('div');
            promptDiv.className = 'prompt';
            promptDiv.innerHTML = `
                <h3>${prompt.text}</h3>
                <p>Value: <span id="promptValue${index}">${prompt.value}</span> Beans</p>
                <button onclick="votePrompt(${index})">Vote</button>
                <button onclick="purchasePrompt(${index})">Purchase</button>
            `;
            promptList.appendChild(promptDiv);
        });
        updateGraph();
    }

    function votePrompt(index) {
        prompts[index].votes += 1;
        prompts[index].value = 10 + prompts[index].votes * 5; // Update value based on votes
        updatePromptList(); // Refresh the prompt list to show updated values
    }

    function purchasePrompt(index) {
        const prompt = prompts[index];
        if (userBeans >= prompt.value) {
            userBeans -= prompt.value;
            generalFund += prompt.value;
            document.getElementById('beans').innerText = userBeans;
            document.getElementById('generalFund').innerText = generalFund;
            inventory.push(prompt);
            prompts.splice(index, 1); // Remove from prompts
            updatePromptList();
            updateInventory();
        } else {
            alert('Not enough beans to purchase this prompt!');
        }
    }

    function updateInventory() {
        const inventoryList = document.getElementById('inventoryList');
        inventoryList.innerHTML = '';
        inventory.forEach(item => {
            const listItem = document.createElement('li');
            listItem.textContent = item.text;
            inventoryList.appendChild(listItem);
        });
    }

    function updateGraph() {
        const labels = prompts.map((_, index) => `Prompt ${index + 1}`);
        const data = prompts.map(prompt => prompt.value);

        if (chart) {
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
        } else {
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Prompt Value in Beans',
                        data: data,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    }

    // Simulate real-time market changes using Perlin noise
    setInterval(() => {
        noiseOffset += 0.1; // Increment the noise offset
        prompts.forEach((prompt, index) => {
            const noiseValue = noise.noise2D(index, noiseOffset); // Get noise value
            const fluctuation = Math.floor(noiseValue * 5); // Scale the noise value
            prompt.value = Math.max(0, prompt.value + fluctuation); // Update value based on noise
            document.getElementById(`promptValue${index}`).innerText = prompt.value; // Update displayed value
        });
        updateGraph();
    }, 1000);

    // Bank buyback function
    function bankBuyback() {
        if (generalFund > 0 && prompts.length > 0) {
            const randomIndex = Math.floor(Math.random() * prompts.length);
            const promptToBuy = prompts[randomIndex];
            if (generalFund >= promptToBuy.value) {
                generalFund -= promptToBuy.value;
                userBeans += promptToBuy.value; // Add purchase price to user's beans
                document.getElementById('generalFund').innerText = generalFund;
                document.getElementById('beans').innerText = userBeans; // Update user's beans
                inventory.push(promptToBuy);
                prompts.splice(randomIndex, 1); // Remove from prompts
                updatePromptList();
                updateInventory();
                logBuyback(promptToBuy.text, promptToBuy.value); // Log the buyback
            }
        }
    }

    // Log bank buyback in the buyback log
    function logBuyback(promptText, purchasePrice) {
        const buybackList = document.getElementById('buybackList');
        const listItem = document.createElement('li');
        listItem.textContent = `Bank bought back: ${promptText} for ${purchasePrice} Beans`;
        buybackList.appendChild(listItem);
    }

    // Set interval for bank buyback
    setInterval(bankBuyback, 5000); // Bank buys back every 5 seconds

    // Function to add random prompts
    function addRandomPrompt() {
        const randomPrompts = [
            "What if cats ruled the world?",
            "Describe a day in the life of a time traveler.",
            "What would happen if gravity was reversed?",
            "Imagine a world where everyone can fly.",
            "What if we could communicate with animals?",
            "Describe a futuristic city.",
            "What if dreams were real?",
            "Imagine a society without money.",
            "What if you could live in any book?",
            "Describe a new sport that combines elements of existing sports."
        ];
        const randomIndex = Math.floor(Math.random() * randomPrompts.length);
        const promptText = randomPrompts[randomIndex];
        const prompt = { text: promptText, value: 10, votes: 0 };
        prompts.push(prompt);
        updatePromptList();
    }

    // Set interval for adding random prompts
    setInterval(addRandomPrompt, 10000); // Add a random prompt every 10 seconds

    // Function to give random beans to the user
    function giveRandomBeans() {
        const randomBeans = Math.floor(Math.random() * 20) + 1; // Random beans between 1 and 20
        userBeans += randomBeans;
        document.getElementById('beans').innerText = userBeans;
    }

    // Set interval for giving random beans
    setInterval(giveRandomBeans, 7000); // Give random beans every 7 seconds

</script>
</body>
</html>
