<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Blockchain NFT Prompts</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            position: relative;
            transition: background-color 0.5s; /* Smooth transition for background color */
        }
        h1 {
            text-align: center;
        }
        #promptForm {
            margin-bottom: 20px;
        }
        #promptList {
            margin-top: 20px;
        }
        .prompt {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .prompt h3 {
            margin: 0;
        }
        #graphContainer {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            height: 300px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 10px;
        }
        #graph {
            width: 100%;
            height: 100%;
        }
        #inventory {
            margin-top: 20px;
        }
        #buybackLog {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 10px;
        }
    </style>
</head>
<body>

<h1>Dynamic Blockchain NFT Prompts</h1>
<div>
    <label for="beans">Your Beans: </label>
    <span id="beans">100</span>
</div>
<div>
    <label for="generalFund">General Fund: </label>
    <span id="generalFund">0</span>
</div>

<div id="promptForm">
    <input type="text" id="promptInput" placeholder="Enter your prompt" />
    <button id="addPromptBtn">Add Prompt (10 Beans)</button>
</div>

<div id="promptList"></div>
<div id="inventory">
    <h2>Your Inventory</h2>
    <ul id="inventoryList"></ul>
</div>
<div id="graphContainer">
    <canvas id="graph"></canvas>
</div>
<div id="buybackLog">
    <h2>Bank Buyback Log</h2>
    <ul id="buybackList"></ul>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let userBeans = 100;
    let generalFund = 0;
    const prompts = [];
    const inventory = [];
    const ctx = document.getElementById('graph').getContext('2d');
    let chart;
    const inspiringPhrases = [
        "The only limit to our realization of tomorrow is our doubts of today.",
        "Do not wait to strike till the iron is hot, but make it hot by striking.",
        "Success is not the key to happiness. Happiness is the key to success.",
        "What lies behind us and what lies before us are tiny matters compared to what lies within us.",
        "The future belongs to those who believe in the beauty of their dreams."
    ];

    document.getElementById('addPromptBtn').addEventListener('click', addPrompt);
    document.getElementById('promptInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            addPrompt();
        }
    });

    function addPrompt() {
        const promptText = document.getElementById('promptInput').value;
        if (promptText && userBeans >= 10) {
            userBeans -= 10;
            document.getElementById('beans').innerText = userBeans;
            const prompt = { text: promptText, value: 10, votes: 0 };
            prompts.push(prompt);
            document.getElementById('promptInput').value = '';
            updatePromptList();
        } else {
            changeBackgroundColor(); // Change background color if not enough beans
        }
    }

    function updatePromptList() {
        const promptList = document.getElementById('promptList');
        promptList.innerHTML = '';
        prompts.forEach((prompt, index) => {
            const promptDiv = document.createElement('div');
            promptDiv.className = 'prompt';
            promptDiv.innerHTML = `
                <h3>${prompt.text}</h3>
                <p>Value: <span id="promptValue${index}">${prompt.value}</span> Beans</p>
                <button onclick="votePrompt(${index})">Vote</button>
                <button onclick="purchasePrompt(${index})">Purchase</button>
                <button onclick="mutatePrompt(${index})">Mutate (Cost: ${Math.floor(prompt.value / 2)} Beans)</button>
            `;
            promptList.appendChild(promptDiv);
        });
        updateGraph();
    }

    function votePrompt(index) {
        prompts[index].votes += 1;
        prompts[index].value = 10 + prompts[index].votes * 5; // Update value based on votes
        updatePromptList(); // Refresh the prompt list to show updated values
    }

    function purchasePrompt(index) {
        const prompt = prompts[index];
        if (userBeans >= prompt.value) {
            userBeans -= prompt.value;
            generalFund += prompt.value;
            document.getElementById('beans').innerText = userBeans;
            document.getElementById('generalFund').innerText = generalFund;
            inventory.push(prompt);
            prompts.splice(index, 1); // Remove from prompts
            updatePromptList();
            updateInventory();
        } else {
            changeBackgroundColor(); // Change background color if not enough beans
        }
    }

    function mutatePrompt(index) {
        const prompt = prompts[index];
        const mutationCost = Math.floor(prompt.value / 2);
        if (userBeans >= mutationCost) {
            userBeans -= mutationCost;
            document.getElementById('beans').innerText = userBeans;

            const randomIndex = Math.floor(Math.random() * prompts.length);
            const randomPrompt = prompts[randomIndex].text; // Get a random prompt for mutation
            const mutatedPrompt = `${prompt.text} - ${randomPrompt}`;
            const newPrompt = { text: mutatedPrompt, value: 10, votes: 0 };
            prompts.push(newPrompt);
            updatePromptList();
        } else {
            changeBackgroundColor(); // Change background color if not enough beans
        }
    }

    function updateInventory() {
        const inventoryList = document.getElementById('inventoryList');
        inventoryList.innerHTML = '';
        inventory.forEach(item => {
            const listItem = document.createElement('li');
            listItem.textContent = item.text;
            inventoryList.appendChild(listItem);
        });
    }

    function updateGraph() {
        const labels = prompts.map((_, index) => `Prompt ${index + 1}`);
        const data = prompts.map(prompt => prompt.value);

        if (chart) {
            chart.data.labels = labels;
            chart.data.datasets[0].data = data;
            chart.update();
        } else {
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Prompt Value in Beans',
                        data: data,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    }

    // Simulate real-time market changes
    setInterval(() => {
        prompts.forEach((prompt, index) => {
            const fluctuation = Math.floor(Math.random() * 5) - 2; // Random fluctuation
            prompt.value = Math.max(0, prompt.value + fluctuation); // Adjust value
            document.getElementById(`promptValue${index}`).innerText = prompt.value; // Update displayed value
        });
        updateGraph();
    }, 1000);

    // Function to mutate a random prompt every 10 seconds
    setInterval(() => {
        if (prompts.length > 0) {
            const randomIndex = Math.floor(Math.random() * prompts.length);
            mutatePrompt(randomIndex);
        }
    }, 10000); // 10 seconds

    // Function to add a new prompt from the fixed list every 30 seconds
    setInterval(() => {
        if (inspiringPhrases.length > 0) {
            const randomPhraseIndex = Math.floor(Math.random() * inspiringPhrases.length);
            const newPromptText = inspiringPhrases[randomPhraseIndex];
            addPromptFromFixedList(newPromptText);
        }
    }, 30000); // 30 seconds

    function addPromptFromFixedList(promptText) {
        if (userBeans >= 10) {
            userBeans -= 10;
            document.getElementById('beans').innerText = userBeans;
            const prompt = { text: promptText, value: 10, votes: 0 };
            prompts.push(prompt);
            updatePromptList();
        } else {
            changeBackgroundColor(); // Change background color if not enough beans
        }
    }

    // Function to add random amounts to the general fund every 30 seconds
    setInterval(() => {
        const randomAmount = Math.floor(Math.random() * 20) + 1; // Random amount between 1 and 20
        generalFund += randomAmount;
        document.getElementById('generalFund').innerText = generalFund;
    }, 30000); // 30 seconds

    // Bank buyback function
    function bankBuyback() {
        if (generalFund > 0 && prompts.length > 0) {
            const randomIndex = Math.floor(Math.random() * prompts.length);
            const promptToBuy = prompts[randomIndex];
            if (generalFund >= promptToBuy.value) {
                generalFund -= promptToBuy.value;
                userBeans += promptToBuy.value; // Add purchase price to user's beans
                document.getElementById('generalFund').innerText = generalFund;
                document.getElementById('beans').innerText = userBeans; // Update user's beans
                inventory.push(promptToBuy);
                prompts.splice(randomIndex, 1); // Remove from prompts
                updatePromptList();
                updateInventory();
                logBuyback(promptToBuy.text, promptToBuy.value); // Log the buyback
            }
        }
    }

    // Log bank buyback in the buyback log
    function logBuyback(promptText, purchasePrice) {
        const buybackList = document.getElementById('buybackList');
        const listItem = document.createElement('li');
        listItem.textContent = `Bank bought back: ${promptText} for ${purchasePrice} Beans`;
        buybackList.appendChild(listItem);
    }

    // Set interval for bank buyback
    setInterval(bankBuyback, 5000); // Bank buys back every 5 seconds

    // Function to change the background color to a random color
    function changeBackgroundColor() {
        const randomColor = '#' + Math.floor(Math.random() * 16777215).toString(16);
        document.body.style.backgroundColor = randomColor;
    }

</script>
</body>
</html>
