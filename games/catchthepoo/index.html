<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        background-color: #0099cc;
        margin: 0;
        padding: 0;
        font-family: sans-serif;
      }
      canvas {
        display: block;
        margin: auto;
        background-color: #0099cc;
        border: 1px solid #ccc;
        width: 50%;
        height: 50%;
      }
      .score {
        position: absolute;
        top: 10px;
        left: 10px;
        font-size: 24px;
      }
    </style>
  </head>
  <body>
    <div class="score">Score: <span id="score">0</span></div>
    <canvas id="canvas"></canvas>
    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const scoreElement = document.getElementById("score");
      let score = 0;
      let currentPoop = null;
      let gameStarted = false;
      let countdown = 3;
      let countdownInterval;

      const toilet = {
        x: canvas.width / 2,
        y: canvas.height - 30,
        width: 50,
        height: 30,
        speed: 20,
      };

      function drawText(x, y, text, fontSize, color) {
        ctx.font = `${fontSize}px sans-serif`;
        ctx.fillStyle = color;
        ctx.fillText(text, x, y);
      }

      function drawPoop() {
        if (!gameStarted) return; // Don't spawn poop until game starts

        if (!currentPoop) {
          const x = Math.floor(Math.random() * canvas.width);
          currentPoop = { x, y: 0 };
        }
        currentPoop.y += 0.75; // Adjusted Speed (50% faster - changed from 0.5 to 0.75)
        drawText(currentPoop.x, currentPoop.y, "ðŸ’©", 15, "#996633");
        if (currentPoop.y > canvas.height) {
          currentPoop = null;
        }
        if (
          currentPoop.y + 15 > toilet.y &&
          currentPoop.y < toilet.y + toilet.height &&
          currentPoop.x + 15 > toilet.x &&
          currentPoop.x < toilet.x + toilet.width
        ) {
          currentPoop = null;
          score++;
          scoreElement.textContent = score;
        }
      }

      function moveToilet(event) {
        ctx.clearRect(toilet.x, toilet.y, toilet.width, toilet.height);

        if (event.keyCode === 37) {
          // Left arrow
          toilet.x = Math.max(0, toilet.x - toilet.speed); //Prevent going off screen
        } else if (event.keyCode === 39) {
          // Right arrow
          toilet.x = Math.min(canvas.width - toilet.width, toilet.x + toilet.speed); //Prevent going off screen
        }

        drawText(toilet.x, toilet.y, "ðŸš½", 15, "#336699");
      }

      function startGame() {
        countdownInterval = setInterval(() => {
          countdown--;
          if (countdown === 0) {
            clearInterval(countdownInterval);
            gameStarted = true;
            countdown = "Begin!"; //Or any other starting message
          }
        }, 1000); // Update every 1 second

      }

      function gameLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        drawText(toilet.x, toilet.y, "ðŸš½", 15, "#336699"); //Redraw Toilet
        drawPoop();

        if (!gameStarted) {
           drawText(canvas.width/2 - 20, canvas.height/2, countdown, 30, "#fff"); //draw countdown in the middle

        }
        requestAnimationFrame(gameLoop);
      }
       // Initial draw of the toilet
      drawText(toilet.x, toilet.y, "ðŸš½", 15, "#336699");

      startGame();
      document.addEventListener("keydown", moveToilet);
      gameLoop();
    </script>
  </body>
</html>
