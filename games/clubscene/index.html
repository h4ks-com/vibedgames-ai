<!DOCTYPE html>
<html>
<head>
    <title>Curved Road With Cars and Headlights</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000; /* Background color for the body */
        }
        a-scene {
            display: block; /* Ensure the scene takes whole viewport */
        }
    </style>
</head>
<body>
    <a-scene>
        <!-- Green Floor -->
        <a-box position="0 0.05 0" width="100" height="0.1" depth="100" color="green"></a-box>
        
        <!-- Sinusoidal Road -->
        <a-entity id="curved-road" position="0 0.1 0"></a-entity>
        
        <!-- White Road Boundaries -->
        <a-entity id="road-boundaries" position="0 0.1 0"></a-entity>
        
        <!-- Camera -->
        <a-camera position="0 5 20"></a-camera>
        
        <!-- Sky -->
        <a-sky color="#87CEEB"></a-sky>
        
        <!-- Billboard Container -->
        <a-entity id="structures"></a-entity>
        
        <!-- Cars will be generated here -->
        <a-entity id="cars"></a-entity>
    </a-scene>

    <script>
        const roadWidth = 12.5; 
        const roadLength = 100;
        const roadSegments = 100; // Number of segments for the sinusoidal curve

        function createCurvedRoad() {
            for (let i = 0; i < roadSegments; i++) {
                const positionZ = (i / roadSegments) * roadLength - (roadLength / 2);
                const sinValue = Math.sin((i / roadSegments) * Math.PI * 2) * (roadWidth / 2);

                const segment = document.createElement('a-box');
                segment.setAttribute('width', 1);
                segment.setAttribute('height', 0.1);
                segment.setAttribute('depth', 2);
                segment.setAttribute('color', 'black');
                segment.setAttribute('position', `${sinValue} 0.05 ${positionZ}`);
                segment.setAttribute('rotation', '0 90 0'); // Rotate to lay flat on the ground

                document.getElementById('curved-road').appendChild(segment);
            }
        }

        function createRoadBoundaries() {
            // Create left and right boundaries
            const boundaryWidth = 0.2; // Width of the boundary sections
            
            for (let i = 0; i < roadSegments; i++) {
                const positionZ = (i / roadSegments) * roadLength - (roadLength / 2);
                const sinValueLeft = Math.sin((i / roadSegments) * Math.PI * 2) * (roadWidth / 2) - (roadWidth / 2) - (boundaryWidth / 2);
                const sinValueRight = Math.sin((i / roadSegments) * Math.PI * 2) * (roadWidth / 2) + (roadWidth / 2) + (boundaryWidth / 2);

                // Left boundary
                const leftBoundary = document.createElement('a-box');
                leftBoundary.setAttribute('width', boundaryWidth);
                leftBoundary.setAttribute('height', 0.1);
                leftBoundary.setAttribute('depth', 2);
                leftBoundary.setAttribute('color', 'white');
                leftBoundary.setAttribute('position', `${sinValueLeft} 0.1 ${positionZ}`);
                leftBoundary.setAttribute('rotation', '0 90 0');
                document.getElementById('road-boundaries').appendChild(leftBoundary);

                // Right boundary
                const rightBoundary = document.createElement('a-box');
                rightBoundary.setAttribute('width', boundaryWidth);
                rightBoundary.setAttribute('height', 0.1);
                rightBoundary.setAttribute('depth', 2);
                rightBoundary.setAttribute('color', 'white');
                rightBoundary.setAttribute('position', `${sinValueRight} 0.1 ${positionZ}`);
                rightBoundary.setAttribute('rotation', '0 90 0');
                document.getElementById('road-boundaries').appendChild(rightBoundary);
            }
        }

        function createBuilding() {
            const randomWidth = Math.random() * 4 + 1; // Width between 1 and 5
            const randomHeight = Math.random() * 10 + 3; // Height between 3 and 13
            
            let xPosition, zPosition;

            // Position building outside the road area
            if (Math.random() < 0.5) {
                // Position to the right of the road
                xPosition = Math.random() * (40 - (randomWidth / 2)) + (6.25 + (randomWidth / 2)); // Adjusted for new road width
            } else {
                // Position to the left of the road
                xPosition = Math.random() * (40 - (randomWidth / 2)) - (6.25 + (randomWidth / 2)); // Adjusted for new road width
            }
            zPosition = Math.random() * 80 - 40; // Random Z position

            // Create normal building
            const building = document.createElement('a-box');
            const randomColor = `hsl(${Math.random() * 360}, 100%, 50%)`; // Random color

            building.setAttribute('color', randomColor);
            building.setAttribute('width', randomWidth);
            building.setAttribute('depth', randomWidth);
            building.setAttribute('height', randomHeight);
            building.setAttribute('position', `${xPosition} ${randomHeight / 2} ${zPosition}`);

            // Attach building to the scene
            document.getElementById('structures').appendChild(building);
        }

        function createCar() {
            const carColors = ['red', 'blue', 'yellow', 'green', 'purple', 'orange'];
            const car = document.createElement('a-entity');
            const randomColor = carColors[Math.floor(Math.random() * carColors.length)];

            const carWidth = 1; // Width of the car
            const carLength = carWidth * 1.5; // Length of the car is 1.5 times the width
            const laneOffset = Math.random() > 0.5 ? -6 : 6; // Adjusted for new road width
            const startZ = 50; // Start position on the Z axis
            const randomSpeed = (Math.random() * 3 + 2) * 0.5; // Random speed between 1 and 3.5 units

            const carBody = document.createElement('a-box');
            carBody.setAttribute('color', randomColor);
            carBody.setAttribute('position', `0 0.25 0`);
            carBody.setAttribute('width', carWidth);
            carBody.setAttribute('length', carLength); // Use length for visuals
            carBody.setAttribute('depth', 0.5); // Depth of the car

            // Create headlights
            for (let i = -1; i <= 1; i += 2) {
                const headlight = document.createElement('a-sphere');
                headlight.setAttribute('position', `${i * 0.65} 0.25 0.5`); // Position in front of the car
                headlight.setAttribute('radius', 0.15);
                headlight.setAttribute('color', 'white');
                carBody.appendChild(headlight);
            }

            car.appendChild(carBody);
            document.getElementById('cars').appendChild(car);

            // Move the car along the sinusoidal path
            let positionZ = startZ;
            function drive() {
                positionZ -= randomSpeed;
                
                // Calculate the X position based on the Z position using the sine function
                const sineIndex = ((positionZ + 50) / 100) * Math.PI * 2; // Normalize the Z position
                const sinValue = Math.sin(sineIndex) * (roadWidth / 2); // Calculate the X position based on sine

                car.setAttribute('position', `${sinValue + laneOffset} 0.25 ${positionZ}`); // Add lane offset

                if (positionZ < -50) {
                    // Reset car position after it leaves the scene
                    positionZ = 50;
                }
                requestAnimationFrame(drive);
            }
            requestAnimationFrame(drive);
        }

        // Create the sinusoidal road and boundaries
        createCurvedRoad();
        createRoadBoundaries();

        // Create 10 buildings
        for (let i = 0; i < 10; i++) {
            createBuilding();
        }

        // Create cars at random intervals
        setInterval(createCar, 1000); // Create a new car every second
    </script>
</body>
</html>
