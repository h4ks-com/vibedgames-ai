<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FizzBuzz Voyager Deluxe — Cheese Edition</title>
  <style>
    :root{
      --bg: #fff9c4;           /* pale cheese */
      --blue: #b3e5fc;         /* light sky */
      --mint: #b2f5ea;         /* minty */
      --text: #1e1e1e;          
      --muted: #555;
      --accent: #ffce54;        /* cheese-ish */
      --card: #fff;
      --shadow: 0 6px 16px rgba(0,0,0,.08);
      --radius: 14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial; background:var(--bg); color:var(--text);}    
    #cheese-game-container{min-height:100%; display:flex; align-items:center; justify-content:center; padding:16px;}
    .screen{display:none; width:100%; max-width:760px;}
    .screen.active{display:block;}
    header.fbv-header{display:flex; align-items:center; gap:12px; padding:18px; border-radius:12px; background:#fff; box-shadow:var(--shadow); margin-bottom:12px;}
    header.fbv-header h1{font-size:1.4rem; margin:0;}
    header.fbv-header p{margin:0; color:var(--muted); font-size:.95rem}

    .card{ background: #fff; border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); border:1px solid #eee; }
    .onboard-grid{ display:grid; gap:14px; }
    .onboard-grid ul{ padding-left:1.2em; margin:0; }
    .btn{ background:#ffc107; color:#2b2b2b; border:0; border-radius:12px; padding:12px 16px; font-weight:600; cursor:pointer; box-shadow: inset 0 -2px 0 rgba(0,0,0,.05); }
    .btn:focus{ outline:2px solid #333; outline-offset:2px; }
    .btn.secondary{ background:#e0e0e0; color:#1a1a1a; }
    .btn[disabled]{ opacity:.5; cursor:not-allowed; }
    .flex{ display:flex; gap:12px; align-items:center; }
    .row{ display:flex; flex-direction:row; gap:12px; align-items:center; justify-content:space-between; }
    /* Game layout */
    #prompt-area{ padding:14px 0; text-align:left; }
    #prompt-text{ font-size:1.05rem; line-height:1.4; color:var(--text); }
    #prompt-counter{ font-size:.9rem; color:var(--muted); }
    .options{ display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px; }
    .option-btn{ min-height:48px; padding:12px 14px; border-radius:12px; border:1px solid #ddd; background:#fff; font-weight:600; cursor:pointer; font-size:1rem; text-align:left; }
    .option-btn:focus{ outline:2px solid #333; outline-offset:2px; }
    .score-live{ position:absolute; left:-9999px; }
    .cheese-icon{ width:48px; height:48px; }
    /* SVG cheese defs */
    svg.inline-cheese{ width:28px; height:28px; vertical-align:middle; margin-right:6px; }

    #screen-title{ display:flex; align-items:center; gap:8px; font-weight:700; margin-bottom:6px; }
    .footer{ margin-top:14px; color:var(--muted); font-size:.9rem; text-align:center; }

    /* Result screen */
    #final-score{ font-size:2rem; font-weight:800; margin:6px 0; }
    #final-ending{ white-space:pre-wrap; line-height:1.4; color:#333; }

    @media (min-width: 560px){
      .options{ grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
  <div id="cheese-game-container" aria-label="Cheese game container" role="main">
    <header class="fbv-header" aria-label="game header">
      <!-- Inline cheese icon in header -->
      <svg class="inline-cheese" aria-hidden="true" focusable="false" viewBox="0 0 64 64">
        <path d="M2 44c6-3 12-3 18-1 6 2 12 7 22 6 4-1 6-3 8-5 1-1 2-3 2-5-1-7-4-8-7-8-3 0-5 1-9 4-3 2-9 4-14 1-4-2-6-5-8-7-2-3-4-7-6-9C2 6 14 4 18 8c6 6 4 16 4 19 0 8-4 9-4 9-2 0-24-6-16 16z" fill="#ffd54f" stroke="#fbc02d" stroke-width="2"/>
      </svg>
      <h1 style="margin:0; font-size:1.2rem;">FizzBuzz Voyager Deluxe — Cheese Edition</h1>
    </header>

    <!-- Onboarding screen -->
    <section id="screen-onboarding" class="screen active" aria-label="onboarding screen">
      <div class="card">
        <div id="screen-title"><svg class="inline-cheese" aria-hidden="true" viewBox="0 0 64 64"><path d="M2 44c6-3 12-3 18-1 6 2 12 7 22 6 4-1 6-3 8-5 1-1 2-3 2-5-1-7-4-8-7-8-3 0-5 1-9 4-3 2-9 4-14 1-4-2-6-5-8-7-2-3-4-7-6-9C2 6 14 4 18 8c6 6 4 16 4 19 0 8-4 9-4 9-2 0-24-6-16 16z" fill="#ffd54f" stroke="#fbc02d" stroke-width="2"/></svg> Cheese Onboarding</div>
        <p>Welcome traveler! Solve 6 cheese-powered prompts to discover your vibe. Each prompt offers 3 tasty choices. Scores add up to reveal your Market Vibe.</p>
        <ul>
          <li>6 prompts, 3 options each</li>
          <li>Score range per prompt: 1, 2 or 3</li>
          <li>Final ending aligns with your total score</li>
        </ul>
        <div class="flex" style="justify-content:flex-end; margin-top:8px;">
          <button id="btn-start" class="btn" aria-label="Start the cheese adventure">Start</button>
        </div>
      </div>
    </section>

    <!-- Game screen -->
    <section id="screen-game" class="screen" aria-label="game screen">
      <div class="card" style="position:relative;">
        <div id="prompt-area">
          <div id="screen-title" style="font-size:1rem; margin-bottom:6px; color:var(--muted);">
            <span id="prompt-counter">Prompt 1 of 6</span>
            <span aria-hidden="true" style="margin-left:auto">
              <svg class="cheese-icon" aria-label="cheese icon" viewBox="0 0 24 24"><path d="M4 12a4 4 0 1 0 8 0c0-3-4-6-4-6s-4 2-4 6z" fill="#ffd54f" stroke="#f6c243" stroke-width="1"/></svg>
            </span>
          </div>
          <div id="prompt-text" aria-live="polite">Loading...</div>
        </div>
        <div class="options" id="options-container" aria-label="options container">
          <button class="option-btn" id="btn-option-1" aria-label="Option 1"></button>
          <button class="option-btn" id="btn-option-2" aria-label="Option 2"></button>
          <button class="option-btn" id="btn-option-3" aria-label="Option 3"></button>
        </div>
        <div class="flex" style="justify-content:space-between; align-items:center; margin-top:12px;">
          <div id="score-display" aria-live="polite" style="font-weight:600; color:#333;">
            Score: 0
          </div>
          <!-- decorative cheese icon in aria-friendly way -->
        </div>
        <!-- hidden live region for accessibility updates -->
        <span id="score-live" class="score-live" aria-live="polite"></span>
        <svg class="inline-cheese" aria-hidden="true" style="position:absolute; right:12px; bottom:12px; width:28px; height:28px;" viewBox="0 0 64 64">
          <path d="M2 44c6-3 12-3 18-1 6 2 12 7 22 6 4-1 6-3 8-5 1-1 2-3 2-5-1-7-4-8-7-8-3 0-5 1-9 4-3 2-9 4-14 1-4-2-6-5-8-7-2-3-4-7-6-9C2 6 14 4 18 8c6 6 4 16 4 19 0 8-4 9-4 9-2 0-24-6-16 16z" fill="#ffd54f" stroke="#fbc02d" stroke-width="2"/>
        </svg>
      </div>
    </section>

    <!-- Result screen -->
    <section id="screen-result" class="screen" aria-label="result screen">
      <div class="card" style="text-align:center;">
        <h2 style="margin-top:0;">Your Cheese Vibe Ending</h2>
        <div id="final-score" aria-label="final score">0</div>
        <div id="final-ending" style="margin:6px 0 12px; font-size:1rem; color:#333;"></div>
        <button id="btn-replay" class="btn" aria-label="Play again">Play Again</button>
      </div>
    </section>

    <footer class="footer" aria-label="footer info">
      <p>Tip: you can replay at any time after finishing.</p>
    </footer>
  </div>

  <!-- Cheese wedge icon definitions (inline SVG) -->
  <svg width="0" height="0" style="position:absolute;">
    <defs>
      <symbol id="icon-cheese" viewBox="0 0 64 64">
        <path d="M8 42c6-3 12-3 18-1 6 2 12 7 22 6 4-1 6-3 8-5 1-1 2-3 1-5-1-7-4-8-7-8-3 0-5 1-9 4-3 2-9 4-14 1-4-2-6-5-8-7-2-3-4-7-6-9C2 6 14 4 18 8c6 6 4 16 4 19 0 8-4 9-4 9-2 0-24-6-16 16z" fill="#ffd54f" stroke="#fbc02d" stroke-width="2"/>
      </symbol>
    </defs>
  </svg>

  <script>
    // Core design and data model
    // 1) Six prompts with three options each. Each option has a score (1|2|3) and a small tag.
    const prompts = [
      {
        text: "The market is bright and breezy as sunlit stalls glow with fresh cheese.",
        options: [
          { text: "Cheddar", score: 1, tag: 'classic' },
          { text: "Brie", score: 3, tag: 'fancy' },
          { text: "Gouda", score: 2, tag: 'bold' }
        ]
      },
      {
        text: "A vendor smiles and asks how you'd like to enjoy your bite today.",
        options: [
          { text: "Pair with wine", score: 3, tag: 'fancy' },
          { text: "Add crackers", score: 1, tag: 'classic' },
          { text: "Save for later", score: 2, tag: 'bold' }
        ]
      },
      {
        text: "Back at the counter, you picture creamy textures and little sparkles of flavor.",
        options: [
          { text: "Cheddar", score: 1, tag: 'classic' },
          { text: "Brie", score: 3, tag: 'fancy' },
          { text: "Gouda", score: 2, tag: 'bold' }
        ]
      },
      {
        text: "Another stall hums with bells—what's your snack plan for joy?",
        options: [
          { text: "Pair with wine", score: 3, tag: 'fancy' },
          { text: "Add crackers", score: 1, tag: 'classic' },
          { text: "Save for later", score: 2, tag: 'bold' }
        ]
      },
      {
        text: "You spot Gouda, Brie, and Cheddar—bold, fancy, or classic—what's your vibe?",
        options: [
          { text: "Gouda", score: 2, tag: 'bold' },
          { text: "Brie", score: 3, tag: 'fancy' },
          { text: "Cheddar", score: 1, tag: 'classic' }
        ]
      },
      {
        text: "The finale: pair with wine, add crackers, or save for later?",
        options: [
          { text: "Pair with wine", score: 3, tag: 'fancy' },
          { text: "Add crackers", score: 1, tag: 'classic' },
          { text: "Save for later", score: 2, tag: 'bold' }
        ]
      }
    ];

    // Endings text per tier (three lines each)
    const endings = {
      'Mild Mellow': [
        'Soft and mellow—your vibe is mellow cheddar on a sunny breeze.',
        'Calm and cozy, you savor every bite and moment.',
        'Market magic settles into a gentle grin—pleasant and peaceful.'
      ],
      'Cheesy Champion': [
        'Gouda-mazing energy! You are a Cheesy Champion.',
        'Brie-lieve in great taste; your vibe is grate.',
        'Stay grate, champ; your cheesy charisma leads the way.'
      ],
      'Gouda Guru': [
        'Gouda Guru—grate-fully wise, aging like fine cheese.',
        'Your insights are sharp as cheddar and smooth as Gouda.',
        'Share your gouda wisdom with the world—grate ideas!' 
      ]
    };

    // State management
    let currentIndex = 0;
    let totalScore = 0;
    let gameState = 'onboarding'; // onboarding | in-progress | finished

    // DOM refs
    const screenOnboarding = document.getElementById('screen-onboarding');
    const screenGame = document.getElementById('screen-game');
    const screenResult = document.getElementById('screen-result');
    const btnStart = document.getElementById('btn-start');
    const btnReplay = document.getElementById('btn-replay');
    const promptText = document.getElementById('prompt-text');
    const promptCounter = document.getElementById('prompt-counter');
    const option1 = document.getElementById('btn-option-1');
    const option2 = document.getElementById('btn-option-2');
    const option3 = document.getElementById('btn-option-3');
    const optionsContainer = document.getElementById('options-container');
    const scoreDisplay = document.getElementById('score-display');
    const finalScore = document.getElementById('final-score');
    const finalEnding = document.getElementById('final-ending');
    const scoreLive = document.getElementById('score-live');

    // Initialize game state
    function initializeGame(){
      currentIndex = 0;
      totalScore = 0;
      gameState = 'onboarding';
      // UI
      showScreen(screenOnboarding);
      // Ensure options wired once
      removeOptionHandlers();
      // Bind onboarding actions
    }

    function showScreen(screen){
      [screenOnboarding, screenGame, screenResult].forEach(s => s.classList.remove('active'));
      screen.classList.add('active');
    }

    function removeOptionHandlers(){
      // Remove previous listeners by cloning nodes
      [option1, option2, option3].forEach(btn => {
        const newBtn = btn.cloneNode(true);
        btn.parentNode.replaceChild(newBtn, btn);
      });
    }

    // Render a specific prompt
    function renderPrompt(index){
      const p = prompts[index];
      promptText.textContent = p.text;
      // Update options texts and scores
      const opts = p.options;
      option1.textContent = opts[0].text; option1.setAttribute('aria-label', `Option 1: ${opts[0].text}`);
      option1.dataset.score = opts[0].score;
      option2.textContent = opts[1].text; option2.setAttribute('aria-label', `Option 2: ${opts[1].text}`);
      option2.dataset.score = opts[1].score;
      option3.textContent = opts[2].text; option3.setAttribute('aria-label', `Option 3: ${opts[2].text}`);
      option3.dataset.score = opts[2].score;
      promptCounter.textContent = `Prompt ${index+1} of 6`;
      // Ensure options are clickable
      [option1, option2, option3].forEach(btn => {
        btn.onclick = () => handleChoice(parseInt(btn.dataset.score));
      );
      });
      // Update live score
      scoreDisplay.textContent = `Score: ${totalScore}`;
      scoreLive.textContent = `Score updated to ${totalScore}`;
    }

    function handleChoice(scoreDelta){
      totalScore += scoreDelta;
      scoreDisplay.textContent = `Score: ${totalScore}`;
      scoreLive.textContent = `Score updated to ${totalScore}`;
      currentIndex += 1;
      if(currentIndex < prompts.length){
        renderPrompt(currentIndex);
      } else {
        finishGame();
      }
    }

    function finishGame(){
      gameState = 'finished';
      // compute tier
      const scaled = totalScore - 6; // per spec
      let tier = 'Mild Mellow';
      if (scaled <= 3) tier = 'Mild Mellow';
      else if (scaled <= 7) tier = 'Cheesy Champion';
      else tier = 'Gouda Guru';
      // Endings
      const lines = endings[tier];
      finalScore.textContent = `Final Score: ${totalScore}  (${tier})`;
      finalEnding.textContent = lines.join('\n');
      showScreen(screenResult);
    }

    // Start game flow
    btnStart.addEventListener('click', () => {
      gameState = 'in-progress';
      totalScore = 0;
      currentIndex = 0;
      // Show game screen and render first prompt
      showScreen(screenGame);
      renderPrompt(0);
    });

    btnReplay.addEventListener('click', () => {
      initializeGame();
      // Reset onboarding screen to visible
      showScreen(screenOnboarding);
    });

    // Initialize at load
    document.addEventListener('DOMContentLoaded', () => {
      initializeGame();
    });
  </script>
</body>
</html>
