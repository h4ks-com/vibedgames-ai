<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaotic Image Generator</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #000;
        }
        canvas {
            border: 1px solid white;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="320" height="200"></canvas>
    <script>
        function generateRandomCoefficients() {
            return [Math.random(), Math.random(), Math.random(), Math.random()];
        }
        
        function calculateLyapunov(coords, iterations, coeffs) {
            let lyapunov = 0;
            const [a, b, c, d] = coeffs;

            for (let i = 0; i < iterations; i++) {
                const x = coords[0];
                const y = coords[1];

                // Simple chaotic mapping
                let newX = Math.sin(a * y) + c * Math.cos(b * x);
                let newY = Math.sin(b * x) + d * Math.cos(a * y);
                
                coords[0] = newX % 1;
                coords[1] = newY % 1;

                // Calculate the Lyapunov exponent
                lyapunov += Math.log(Math.abs(a * Math.cos(b * x) + d * Math.sin(a * y)));
            }

            return lyapunov / iterations;
        }

        function drawImage() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const data = imageData.data;

            let isChaotic = false;

            while (!isChaotic) {
                const coeffs = generateRandomCoefficients();
                const iterations = 1000;
                const coords = [Math.random(), Math.random()];

                const lyapunov = calculateLyapunov(coords, iterations, coeffs);

                if (lyapunov > 0) {
                    isChaotic = true;
                    for (let i = 0; i < data.length; i += 4) {
                        const pixelX = (i / 4) % canvas.width;
                        const pixelY = Math.floor((i / 4) / canvas.width);

                        // Map coordinates to image and set color based on Lyapunov
                        const colorValue = Math.floor((coords[0] + coords[1]) * 255);
                        data[i]     = colorValue; // Red
                        data[i + 1] = colorValue; // Green
                        data[i + 2] = colorValue; // Blue
                        data[i + 3] = 255;        // Alpha
                    }

                    ctx.putImageData(imageData, 0, 0);
                    setTimeout(() => {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                    }, 5000); // Clear after 5 seconds
                }
            }
        }

        drawImage();
        setInterval(drawImage, 6000); // Generate a new image every 6 seconds
    </script>
</body>
</html>
