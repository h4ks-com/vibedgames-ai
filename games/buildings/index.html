<!DOCTYPE html>
<html>
<head>
    <title>Web VR City Map</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe-gltf-component.min.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: none; }
    </style>
</head>
<body>
    <a-scene>
        <a-sky color="#87CEFA"></a-sky>
        <a-plane position="0 -0.5 0" rotation="-90 0 0" width="5000" height="5000" color="#808080"></a-plane>
        <a-entity id="city-container"></a-entity>
    </a-scene>

    <script>
        const apiEndpoint = "https://api.syte.ms/api/3d/gltf/DENW49AL00009XTX";
        const cityContainer = document.getElementById('city-container');
        
        function getRandomEndpoint() {
            const randomSuffix = String.fromCharCode(Math.random() * 26 + 65) +
                                 String.fromCharCode(Math.random() * 26 + 65) +
                                 String.fromCharCode(Math.random() * 26 + 65); 
            return apiEndpoint.slice(0, -3) + randomSuffix; // Replace last 3 characters
        }

        function loadBuilding() {
            const modelUrl = getRandomEndpoint();
            const building = document.createElement('a-entity');
            building.setAttribute('gltf-model', modelUrl);
            building.setAttribute('position', `${Math.random() * 100 - 50} 0 ${Math.random() * 100 - 50}`);
            building.setAttribute('scale', '0.5 0.5 0.5');
            
            // Try loading the model and retry if it fails
            building.addEventListener('model-loaded', () => {
                console.log(`Loaded model from ${modelUrl}`);
            });
            building.addEventListener('model-error', () => {
                console.log(`Failed to load model from ${modelUrl}, trying another...`);
                loadBuilding(); // Retry loading another building
            });

            // Load the building
            building.setAttribute('gltf-model', modelUrl);
            cityContainer.appendChild(building);
        }

        // Load initial batch of buildings
        for (let i = 0; i < 10; i++) {
            loadBuilding();
        }

        // Load new building every few seconds
        setInterval(loadBuilding, 3000);  // 3 seconds interval
    </script>
</body>
</html>
