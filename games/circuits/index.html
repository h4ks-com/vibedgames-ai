<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circuit Designer - 128 Unique Circuits</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
            height: 100vh;
            color: #eee;
        }

        .app-container {
            display: grid;
            grid-template-columns: 320px 1fr 280px;
            grid-template-rows: 70px 1fr;
            height: 100vh;
        }

        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .logo {
            font-size: 26px;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-controls {
            display: flex;
            gap: 10px;
        }

        .experiments-panel {
            background: #16213e;
            border-right: 1px solid #0f3460;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .panel-header {
            padding: 20px;
            background: #0f3460;
            border-bottom: 2px solid #533483;
        }

        .panel-header h3 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .course-tabs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        .course-tab {
            padding: 10px;
            background: #16213e;
            border: 2px solid #533483;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s;
            color: #aaa;
        }

        .course-tab:hover {
            background: #533483;
            color: white;
        }

        .course-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #764ba2;
        }

        .search-box {
            width: 100%;
            padding: 10px 12px;
            background: #16213e;
            border: 2px solid #533483;
            border-radius: 6px;
            color: white;
            font-size: 13px;
        }

        .experiments-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .experiment-card {
            background: #0f3460;
            border: 2px solid #533483;
            border-radius: 8px;
            padding: 14px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .experiment-card:hover {
            background: #533483;
            transform: translateX(5px);
        }

        .experiment-card.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #764ba2;
        }

        .exp-number {
            font-size: 12px;
            color: #ffd700;
            font-weight: bold;
        }

        .exp-name {
            font-size: 14px;
            color: white;
            margin-top: 5px;
            font-weight: 600;
        }

        .canvas-container {
            background: #f5f5f5;
            position: relative;
            overflow: hidden;
        }

        .canvas-toolbar {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            background: rgba(255,255,255,0.98);
            backdrop-filter: blur(10px);
            padding: 20px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 50;
        }

        .canvas-title {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
        }

        .canvas-subtitle {
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 3px;
        }

        .toolbar-actions {
            display: flex;
            gap: 10px;
        }

        .canvas-view {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            overflow: auto;
        }

        .circuit-canvas {
            position: relative;
            min-width: 100%;
            min-height: 100%;
            padding: 140px 40px 40px 40px;
        }

        .wire-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .wire {
            stroke-width: 4;
            fill: none;
            stroke-linecap: round;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }

        .wire.power { stroke: #e74c3c; }
        .wire.ground { stroke: #2c3e50; }
        .wire.signal { stroke: #3498db; }

        .connection-point {
            fill: #e74c3c;
            stroke: #fff;
            stroke-width: 2;
        }

        .component {
            position: absolute;
            user-select: none;
            z-index: 10;
        }

        /* Component styles - compact for better layout */
        .resistor-body {
            width: 70px;
            height: 25px;
            background: linear-gradient(to right, #D2691E 0%, #8B4513 50%, #D2691E 100%);
            border: 2px solid #654321;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            font-weight: bold;
        }

        .led-body {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle at 35% 35%, #ff6b6b, #c92a2a);
            border: 3px solid #8b0000;
        }

        .led-body.on {
            background: radial-gradient(circle at 35% 35%, #ffeb3b, #ffc107);
            box-shadow: 0 0 30px rgba(255, 235, 59, 0.9);
            animation: glow 1.5s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 30px rgba(255, 235, 59, 0.9); }
            50% { box-shadow: 0 0 45px rgba(255, 235, 59, 1); }
        }

        .ic-body {
            min-width: 100px;
            background: #2c3e50;
            border: 3px solid #34495e;
            border-radius: 8px;
            padding: 15px 20px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .battery-body {
            width: 60px;
            height: 80px;
            background: linear-gradient(to bottom, #2ecc71, #27ae60);
            border: 3px solid #229954;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
            position: relative;
        }

        .battery-body::before {
            content: '';
            position: absolute;
            top: -10px;
            width: 25px;
            height: 10px;
            background: #27ae60;
            border-radius: 3px 3px 0 0;
        }

        .cap-body {
            width: 50px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .cap-plate {
            width: 4px;
            height: 35px;
            background: #2c3e50;
        }

        .ground-body {
            width: 60px;
            height: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            gap: 3px;
        }

        .ground-line {
            background: #2c3e50;
            height: 3px;
        }

        .comp-label {
            position: absolute;
            bottom: -22px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            color: #2c3e50;
            font-weight: bold;
            background: rgba(255,255,255,0.95);
            padding: 2px 8px;
            border-radius: 3px;
            white-space: nowrap;
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.5);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.5);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .components-panel {
            background: #16213e;
            border-left: 1px solid #0f3460;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .component-category {
            background: #0f3460;
            border-radius: 8px;
            padding: 12px;
            border: 1px solid #533483;
        }

        .category-title {
            font-size: 13px;
            color: #ffd700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            margin-bottom: 12px;
            font-weight: bold;
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #0f3460;
        }

        ::-webkit-scrollbar-thumb {
            background: #533483;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <div class="logo">
                <span>‚ö°</span>
                <span>Circuit Designer - 128 Unique Circuits</span>
            </div>
            <div class="header-controls">
                <button class="btn btn-success" onclick="simulateCircuit()">
                    <span>‚ñ∂Ô∏è</span>
                    <span>Simulate</span>
                </button>
                <button class="btn btn-primary" onclick="zoomIn()">üîç+</button>
                <button class="btn btn-primary" onclick="zoomOut()">üîç-</button>
                <button class="btn btn-danger" onclick="clearCircuit()">üóëÔ∏è</button>
            </div>
        </div>

        <div class="experiments-panel">
            <div class="panel-header">
                <h3>üìö All 128 Experiments</h3>
                <div class="course-tabs">
                    <div class="course-tab active" data-course="0">555 Timer</div>
                    <div class="course-tab" data-course="1">ATtiny13</div>
                    <div class="course-tab" data-course="2">ESP8266</div>
                    <div class="course-tab" data-course="3">Raspberry Pi</div>
                </div>
                <input type="text" class="search-box" placeholder="Search..." id="searchBox">
            </div>
            <div class="experiments-list" id="experimentsList"></div>
        </div>

        <div class="canvas-container">
            <div class="canvas-toolbar">
                <div>
                    <div class="canvas-title" id="circuitTitle">Select an Experiment</div>
                    <div class="canvas-subtitle" id="circuitSubtitle">Each circuit is unique!</div>
                </div>
                <div class="toolbar-actions">
                    <span style="color: #7f8c8d; font-size: 12px;">üî¥ Power  ‚ö´ Ground  üîµ Signal</span>
                </div>
            </div>

            <div class="canvas-view">
                <div class="circuit-canvas" id="circuitCanvas">
                    <svg class="wire-layer" id="wireLayer"></svg>
                </div>
            </div>
        </div>

        <div class="components-panel">
            <div class="component-category">
                <div class="category-title">üì¶ Required Components</div>
                <div id="componentsList" style="color: #aaa; font-size: 12px; line-height: 1.8; padding: 10px;">
                    Select an experiment to view required components.
                </div>
            </div>
            <div class="component-category" style="margin-top: 15px;">
                <div class="category-title">üîß Assembly Instructions</div>
                <div id="instructionsList" style="color: #aaa; font-size: 12px; line-height: 1.7; padding: 10px;">
                    Step-by-step instructions will appear here.
                </div>
            </div>
        </div>
    </div>

    <script>
        // COMPLETE UNIQUE CIRCUIT DATABASE - All 128 experiments
        const circuits = {
            // Course 0: 555 Timer & Analog ICs (32 experiments) - VERIFIED WITH TEXT FILES
            0: [
                // Exp 1: Blinking LED (555 Astable)
                { name: "Blinking LED (555 Astable)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:200,y:100,v:'1k',id:'r1'}, {t:'r',x:380,y:100,v:'100k',id:'r2'},
                    {t:'r',x:450,y:180,v:'470',id:'r3'}, {t:'led',x:600,y:180,id:'l'},
                    {t:'c',x:280,y:320,v:'10¬µF',id:'c'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['b','pos','r1','in','power'],
                    ['r1','out','ic','out','signal'], ['b','pos','r2','in','power'],
                    ['r2','out','ic','trig','signal'], ['ic','out','r3','in','signal'],
                    ['r3','out','l','a','signal'], ['l','c','g','in','ground'],
                    ['ic','gnd','g','in','ground'], ['b','neg','g','in','ground']
                ]},

                // Exp 2: LED Brightness Control (PWM)
                { name: "LED Brightness Control (555 PWM)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:200,y:100,v:'1k',id:'r1'}, {t:'pot',x:380,y:100,v:'100k',id:'p'},
                    {t:'r',x:480,y:180,v:'470',id:'r2'}, {t:'led',x:630,y:180,id:'l'},
                    {t:'c',x:280,y:320,v:'10¬µF',id:'c'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['b','pos','p','in','power'],
                    ['p','out','ic','trig','signal'], ['ic','out','r2','in','signal'],
                    ['r2','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                // Exp 3: Electronic Siren
                { name: "Electronic Siren (555 Audio)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:200,y:100,v:'1k',id:'r1'}, {t:'pot',x:380,y:100,v:'10k',id:'p'},
                    {t:'c',x:280,y:320,v:'10¬µF',id:'c1'}, {t:'c',x:450,y:180,v:'100¬µF',id:'c2'},
                    {t:'spk',x:620,y:180,id:'sp'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['b','pos','r1','in','power'],
                    ['r1','out','ic','out','signal'], ['ic','out','c2','in','signal'],
                    ['c2','out','sp','in','signal'], ['sp','out','g','in','ground']
                ]},

                // Exp 4: Touch-Activated Switch
                { name: "Touch-Activated Switch (555 Monostable)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:180,y:100,v:'10k',id:'r1'}, {t:'r',x:220,y:280,v:'1M',id:'r2'},
                    {t:'touch',x:120,y:100,id:'tp'}, {t:'r',x:450,y:180,v:'470',id:'r3'},
                    {t:'led',x:600,y:180,id:'l'}, {t:'c',x:280,y:320,v:'100¬µF',id:'c'},
                    {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['b','pos','r1','in','power'],
                    ['r1','out','ic','trig','signal'], ['tp','out','ic','trig','signal'],
                    ['ic','out','r3','in','signal'], ['r3','out','l','a','signal']
                ]},

                // Exp 5: Automatic Night Light
                { name: "Automatic Night Light (555 + LDR)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'ldr',x:180,y:100,id:'ldr'}, {t:'r',x:180,y:260,v:'100k',id:'r1'},
                    {t:'r',x:380,y:100,v:'1k',id:'r2'}, {t:'r',x:480,y:180,v:'470',id:'r3'},
                    {t:'led',x:630,y:180,id:'l'}, {t:'c',x:280,y:320,v:'10¬µF',id:'c'},
                    {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ldr','in','power'], ['ldr','out','ic','trig','signal'],
                    ['ldr','out','r1','in','signal'], ['r1','out','g','in','ground'],
                    ['ic','out','r3','in','signal'], ['r3','out','l','a','signal']
                ]},

                // Exp 6: Musical Metronome
                { name: "Musical Metronome (555 LED + Sound)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:200,y:100,v:'1k',id:'r1'}, {t:'pot',x:380,y:100,v:'500k',id:'p'},
                    {t:'r',x:420,y:200,v:'470',id:'r2'}, {t:'led',x:570,y:200,id:'l'},
                    {t:'c',x:280,y:340,v:'10¬µF',id:'c1'}, {t:'c',x:480,y:260,v:'100¬µF',id:'c2'},
                    {t:'spk',x:650,y:260,id:'sp'}, {t:'gnd',x:300,y:450,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['ic','out','r2','in','signal'],
                    ['r2','out','l','a','signal'], ['ic','out','c2','in','signal'],
                    ['c2','out','sp','in','signal'], ['sp','out','g','in','ground']
                ]},

                // Exp 7: Racing LED Lights (LED Chaser)
                { name: "Racing LED Lights (555 + 4017)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:220,y:180,id:'ic1'},
                    {t:'pot',x:180,y:100,v:'100k',id:'p'}, {t:'4017',x:400,y:160,id:'ic2'},
                    {t:'led',x:560,y:100,id:'l1'}, {t:'led',x:560,y:160,id:'l2'},
                    {t:'led',x:560,y:220,id:'l3'}, {t:'led',x:560,y:280,id:'l4'},
                    {t:'r',x:660,y:190,v:'470',id:'r'}, {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic1','vcc','power'], ['ic1','out','ic2','clk','signal'],
                    ['ic2','q0','l1','a','signal'], ['ic2','q1','l2','a','signal'],
                    ['ic2','q2','l3','a','signal'], ['ic2','q3','l4','a','signal']
                ]},

                // Exp 8: Servo Motor Controller
                { name: "Servo Motor Controller (555 PWM)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:280,y:180,id:'ic'},
                    {t:'r',x:200,y:100,v:'1k',id:'r1'}, {t:'pot',x:380,y:100,v:'10k',id:'p'},
                    {t:'c',x:280,y:320,v:'10¬µF',id:'c'}, {t:'servo',x:520,y:180,id:'s'},
                    {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['b','pos','s','vcc','power'],
                    ['p','out','ic','trig','signal'], ['ic','out','s','sig','signal'],
                    ['s','gnd','g','in','ground'], ['ic','gnd','g','in','ground']
                ]},

                // Exp 9: Mini Audio Amplifier (LM386)
                { name: "Mini Audio Amplifier (LM386)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm386',x:300,y:180,id:'amp'},
                    {t:'pot',x:180,y:180,v:'10k',id:'p'}, {t:'c',x:450,y:180,v:'220¬µF',id:'c'},
                    {t:'spk',x:620,y:180,id:'sp'}, {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','amp','vcc','power'], ['p','out','amp','in','signal'],
                    ['amp','out','c','in','signal'], ['c','out','sp','in','signal'],
                    ['sp','out','g','in','ground'], ['amp','gnd','g','in','ground']
                ]},

                // Exp 10: Adjustable Power Supply (LM317)
                { name: "Adjustable Power Supply (LM317)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm317',x:300,y:180,id:'reg'},
                    {t:'r',x:300,y:280,v:'240',id:'r1'}, {t:'pot',x:420,y:280,v:'5k',id:'p'},
                    {t:'c',x:200,y:280,v:'100¬µF',id:'c1'}, {t:'c',x:480,y:280,v:'10¬µF',id:'c2'},
                    {t:'r',x:580,y:180,v:'470',id:'r2'}, {t:'led',x:680,y:180,id:'l'},
                    {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[
                    ['b','pos','reg','in','power'], ['reg','out','r2','in','signal'],
                    ['r2','out','l','a','signal'], ['l','c','g','in','ground'],
                    ['reg','adj','r1','in','signal'], ['r1','out','g','in','ground']
                ]},

                // Exp 11: Simple Alarm System (LM358 Op-Amp)
                { name: "Simple Alarm System (LM358 Comparator)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'ldr',x:180,y:120,id:'ldr'},
                    {t:'r',x:180,y:260,v:'10k',id:'r1'}, {t:'lm358',x:350,y:180,id:'op'},
                    {t:'pot',x:350,y:320,v:'10k',id:'p'}, {t:'r',x:520,y:180,v:'470',id:'r2'},
                    {t:'led',x:670,y:180,id:'l'}, {t:'gnd',x:350,y:440,id:'g'}
                ], wires:[
                    ['b','pos','ldr','in','power'], ['ldr','out','op','in+','signal'],
                    ['ldr','out','r1','in','signal'], ['r1','out','g','in','ground'],
                    ['p','out','op','in-','signal'], ['op','out','r2','in','signal'],
                    ['r2','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                // Exp 12: Logic Gates (CD4011 NAND)
                { name: "Logic Gates (CD4011 NAND)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'4017',x:300,y:180,id:'ic'},
                    {t:'btn',x:150,y:100,id:'btn1'}, {t:'btn',x:150,y:160,id:'btn2'},
                    {t:'r',x:220,y:100,v:'10k',id:'r1'}, {t:'r',x:220,y:160,v:'10k',id:'r2'},
                    {t:'r',x:480,y:180,v:'470',id:'r3'}, {t:'led',x:630,y:180,id:'l'},
                    {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['btn1','out','ic','clk','signal'],
                    ['btn2','out','ic','data','signal'], ['ic','q0','r3','in','signal'],
                    ['r3','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                // Exp 13: Temperature Indicator (LM35)
                { name: "Temperature Indicator (LM35)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm35',x:180,y:180,id:'tmp'},
                    {t:'lm358',x:340,y:120,id:'op1'}, {t:'lm358',x:340,y:240,id:'op2'},
                    {t:'led',x:520,y:120,id:'l1'}, {t:'led',x:520,y:200,id:'l2'},
                    {t:'led',x:520,y:280,id:'l3'}, {t:'r',x:450,y:200,v:'470',id:'r'},
                    {t:'pot',x:260,y:320,v:'10k',id:'p'}, {t:'gnd',x:300,y:440,id:'g'}
                ], wires:[
                    ['b','pos','tmp','vcc','power'], ['tmp','out','op1','in+','signal'],
                    ['tmp','out','op2','in+','signal'], ['op1','out','l1','a','signal'],
                    ['op2','out','l2','a','signal'], ['l3','a','g','in','ground']
                ]},

                // Exp 14: Morse Code Trainer (CD4049)
                { name: "Morse Code Trainer (CD4049 Oscillator)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'4017',x:300,y:180,id:'ic'},
                    {t:'btn',x:150,y:120,id:'btn'}, {t:'r',x:220,y:120,v:'10k',id:'r1'},
                    {t:'r',x:420,y:180,v:'100k',id:'r2'}, {t:'c',x:300,y:320,v:'1nF',id:'c'},
                    {t:'spk',x:550,y:180,id:'sp'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[
                    ['b','pos','ic','vcc','power'], ['btn','out','ic','clk','signal'],
                    ['ic','q0','sp','in','signal'], ['sp','out','g','in','ground'],
                    ['ic','gnd','g','in','ground']
                ]},

                // Exp 15: Battery Voltage Monitor (TL431)
                { name: "Battery Monitor (TL431 Reference)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm358',x:280,y:120,id:'tl1'},
                    {t:'lm358',x:280,y:220,id:'tl2'}, {t:'lm358',x:280,y:320,id:'tl3'},
                    {t:'r',x:180,y:220,v:'10k',id:'r1'}, {t:'r',x:180,y:320,v:'10k',id:'r2'},
                    {t:'led',x:450,y:120,id:'l1'}, {t:'led',x:450,y:220,id:'l2'},
                    {t:'led',x:450,y:320,id:'l3'}, {t:'r',x:380,y:220,v:'470',id:'r3'},
                    {t:'gnd',x:300,y:440,id:'g'}
                ], wires:[
                    ['b','pos','r1','in','power'], ['r1','out','r2','in','signal'],
                    ['r2','out','g','in','ground'], ['tl1','out','l1','a','signal'],
                    ['tl2','out','l2','a','signal'], ['tl3','out','l3','a','signal']
                ]},

                // Exp 16: 8-LED Controller (74HC595 Shift Register)
                { name: "8-LED Controller (74HC595)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'74595',x:300,y:160,id:'sr'},
                    {t:'btn',x:150,y:100,id:'btn1'}, {t:'btn',x:150,y:160,id:'btn2'},
                    {t:'btn',x:150,y:220,id:'btn3'}, {t:'r',x:220,y:140,v:'10k',id:'r1'},
                    {t:'led',x:480,y:100,id:'l1'}, {t:'led',x:480,y:140,id:'l2'},
                    {t:'led',x:480,y:180,id:'l3'}, {t:'led',x:480,y:220,id:'l4'},
                    {t:'led',x:480,y:260,id:'l5'}, {t:'led',x:480,y:300,id:'l6'},
                    {t:'r',x:580,y:200,v:'470',id:'r2'}, {t:'gnd',x:320,y:440,id:'g'}
                ], wires:[
                    ['b','pos','sr','data','power'], ['btn1','out','sr','data','signal'],
                    ['btn2','out','sr','clk','signal'], ['btn3','out','sr','data','signal'],
                    ['sr','q0','l1','a','signal'], ['sr','q1','l2','a','signal'],
                    ['sr','q2','l3','a','signal'], ['sr','q3','l4','a','signal']
                ]},

                // Exp 17-32: Advanced Two-IC and Multi-IC Projects
                { name: "Simple Intercom (555 + LM386)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:240,y:140,id:'ic1'},
                    {t:'lm386',x:400,y:200,id:'ic2'}, {t:'pot',x:300,y:280,v:'10k',id:'p'},
                    {t:'c',x:520,y:200,v:'220¬µF',id:'c'}, {t:'spk',x:650,y:200,id:'sp'},
                    {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[['ic1','out','ic2','in','signal'], ['ic2','out','c','in','signal']]},

                { name: "Music Synthesizer (Dual 555 + LM386)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:220,y:140,id:'ic1'},
                    {t:'555',x:220,y:260,id:'ic2'}, {t:'lm386',x:420,y:200,id:'amp'},
                    {t:'pot',x:160,y:200,v:'100k',id:'p'}, {t:'spk',x:620,y:200,id:'sp'},
                    {t:'gnd',x:320,y:420,id:'g'}
                ], wires:[['ic1','out','ic2','cv','signal'], ['ic2','out','amp','in','signal']]},

                { name: "Stable Audio Amplifier (LM317 + LM386)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm317',x:240,y:180,id:'reg'},
                    {t:'lm386',x:420,y:200,id:'amp'}, {t:'c',x:540,y:200,v:'220¬µF',id:'c'},
                    {t:'spk',x:670,y:200,id:'sp'}, {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[['reg','out','amp','vcc','power'], ['amp','out','c','in','signal']]},

                { name: "Automatic Burglar Alarm (LM358 + 555)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'ldr',x:180,y:120,id:'ldr'},
                    {t:'lm358',x:300,y:160,id:'op'}, {t:'555',x:440,y:180,id:'ic'},
                    {t:'buzz',x:700,y:180,id:'bz'}, {t:'pot',x:300,y:300,v:'10k',id:'p'},
                    {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[['op','out','ic','trig','signal'], ['ic','out','bz','in','signal']]},

                { name: "LED Bar Graph Meter (LM3914 + LM358)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm358',x:240,y:180,id:'op'},
                    {t:'pot',x:160,y:180,v:'10k',id:'p'},
                    {t:'led',x:420,y:100,id:'l1'}, {t:'led',x:420,y:140,id:'l2'},
                    {t:'led',x:420,y:180,id:'l3'}, {t:'led',x:420,y:220,id:'l4'},
                    {t:'led',x:420,y:260,id:'l5'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[['p','out','op','in+','signal']]},

                { name: "DC Motor Speed Controller (555 + TIP122)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:260,y:180,id:'ic'},
                    {t:'pot',x:180,y:100,v:'100k',id:'p'}, {t:'trans',x:420,y:180,id:'q'},
                    {t:'motor',x:580,y:180,id:'m'}, {t:'diode',x:530,y:280,id:'d'},
                    {t:'r',x:350,y:180,v:'1k',id:'r'}, {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[['ic','out','r','in','signal'], ['r','out','q','b','signal'], ['q','c','m','in','power']]},

                { name: "Electronic Dice (4017 + 555)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:220,y:180,id:'ic1'},
                    {t:'4017',x:380,y:160,id:'ic2'}, {t:'btn',x:140,y:100,id:'btn'},
                    {t:'led',x:540,y:100,id:'l1'}, {t:'led',x:540,y:160,id:'l2'},
                    {t:'led',x:540,y:220,id:'l3'}, {t:'led',x:540,y:280,id:'l4'},
                    {t:'gnd',x:350,y:440,id:'g'}
                ], wires:[['ic1','out','ic2','clk','signal'], ['ic2','q0','l1','a','signal']]},

                { name: "Simple Theremin (Dual 555 + LM386)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:220,y:140,id:'ic1'},
                    {t:'555',x:220,y:260,id:'ic2'}, {t:'lm386',x:420,y:200,id:'amp'},
                    {t:'touch',x:140,y:140,id:'tp'}, {t:'spk',x:680,y:200,id:'sp'},
                    {t:'gnd',x:320,y:420,id:'g'}
                ], wires:[['ic1','out','ic2','cv','signal'], ['ic2','out','amp','in','signal']]},

                { name: "AM Radio Transmitter", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:240,y:140,id:'ic1'},
                    {t:'lm386',x:380,y:200,id:'ic2'}, {t:'trans',x:540,y:180,id:'q'},
                    {t:'c',x:620,y:140,v:'100pF',id:'c'}, {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[['ic1','out','ic2','in','signal'], ['ic2','out','q','b','signal']]},

                { name: "Light-Controlled Music Box", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:220,y:140,id:'ic1'},
                    {t:'lm358',x:220,y:260,id:'op'}, {t:'ldr',x:140,y:260,id:'ldr'},
                    {t:'lm386',x:400,y:200,id:'amp'}, {t:'4017',x:320,y:140,id:'cnt'},
                    {t:'spk',x:600,y:200,id:'sp'}, {t:'gnd',x:320,y:420,id:'g'}
                ], wires:[['ic1','out','cnt','clk','signal'], ['cnt','q0','amp','in','signal']]},

                { name: "Digital Thermometer Display", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm35',x:180,y:180,id:'tmp'},
                    {t:'lm358',x:300,y:160,id:'op'}, {t:'74595',x:450,y:140,id:'sr'},
                    {t:'oled',x:620,y:180,id:'disp'}, {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[['tmp','out','op','in+','signal'], ['op','out','sr','data','signal']]},

                { name: "Clap-Activated Light Switch", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm358',x:240,y:160,id:'op'},
                    {t:'555',x:380,y:160,id:'ic'}, {t:'4017',x:520,y:160,id:'cnt'},
                    {t:'trans',x:660,y:200,id:'q'}, {t:'led',x:760,y:200,id:'l'},
                    {t:'r',x:710,y:200,v:'220',id:'r'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[['op','out','ic','trig','signal'], ['ic','out','cnt','clk','signal']]},

                { name: "Automatic Plant Watering System", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm358',x:280,y:160,id:'op'},
                    {t:'555',x:420,y:160,id:'ic'}, {t:'lm317',x:280,y:280,id:'reg'},
                    {t:'trans',x:580,y:200,id:'q'}, {t:'motor',x:700,y:200,id:'m'},
                    {t:'gnd',x:350,y:440,id:'g'}
                ], wires:[['op','out','ic','trig','signal'], ['ic','out','q','b','signal']]},

                { name: "Electronic Combination Lock", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'4017',x:280,y:140,id:'cnt1'},
                    {t:'4017',x:280,y:260,id:'cnt2'}, {t:'74595',x:460,y:200,id:'sr'},
                    {t:'btn',x:140,y:120,id:'btn1'}, {t:'btn',x:140,y:180,id:'btn2'},
                    {t:'led',x:620,y:200,id:'l'}, {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[['btn1','out','cnt1','clk','signal'], ['cnt1','q0','sr','data','signal']]},

                { name: "LED Light Show Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'555',x:200,y:140,id:'ic1'},
                    {t:'555',x:200,y:260,id:'ic2'}, {t:'4017',x:360,y:140,id:'cnt1'},
                    {t:'4017',x:360,y:260,id:'cnt2'}, {t:'74595',x:520,y:200,id:'sr'},
                    {t:'gnd',x:380,y:440,id:'g'}
                ], wires:[['ic1','out','cnt1','clk','signal'], ['ic2','out','cnt2','clk','signal']]},

                { name: "Voice-Activated Robot Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'lm358',x:240,y:160,id:'op'},
                    {t:'555',x:380,y:160,id:'ic'}, {t:'74595',x:540,y:160,id:'sr'},
                    {t:'motor',x:700,y:140,id:'m1'}, {t:'motor',x:700,y:240,id:'m2'},
                    {t:'trans',x:620,y:200,id:'q'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[['op','out','ic','trig','signal'], ['ic','out','sr','data','signal']]}
            ],

            // Course 1: ATtiny13 (32 experiments)
            1: [
                { name: "Hello Blink", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'r',x:450,y:200,v:'220',id:'r'}, {t:'led',x:600,y:200,id:'l'},
                    {t:'gnd',x:320,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['mcu','pb0','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground'],
                    ['mcu','gnd','g','in','ground'], ['b','neg','g','in','ground']
                ]},

                { name: "PWM LED Fading", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'r',x:450,y:200,v:'220',id:'r'}, {t:'led',x:600,y:200,id:'l'},
                    {t:'c',x:420,y:320,v:'100nF',id:'c'}, {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['mcu','pb0','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                { name: "Software Siren", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'r',x:450,y:200,v:'100',id:'r'}, {t:'buzz',x:600,y:200,id:'bz'},
                    {t:'c',x:420,y:320,v:'10¬µF',id:'c'}, {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['mcu','pb0','r','in','signal'],
                    ['r','out','bz','in','signal'], ['bz','out','g','in','ground']
                ]},

                { name: "Button Input & Debounce", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'btn',x:150,y:100,id:'btn'}, {t:'r',x:220,y:100,v:'10k',id:'r1'},
                    {t:'r',x:450,y:200,v:'220',id:'r2'}, {t:'led',x:600,y:200,id:'l'},
                    {t:'gnd',x:320,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['btn','out','mcu','pb2','signal'],
                    ['mcu','pb0','r2','in','signal'], ['r2','out','l','a','signal']
                ]},

                { name: "Smart Night Light (LDR)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'ldr',x:180,y:100,id:'ldr'}, {t:'r',x:180,y:240,v:'10k',id:'r1'},
                    {t:'r',x:450,y:200,v:'220',id:'r2'}, {t:'led',x:600,y:200,id:'l'},
                    {t:'gnd',x:320,y:380,id:'g'}
                ], wires:[
                    ['b','pos','ldr','in','power'], ['ldr','out','mcu','adc2','signal'],
                    ['mcu','pb0','r2','in','signal'], ['r2','out','l','a','signal']
                ]},

                { name: "Digital Metronome", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'r',x:450,y:140,v:'220',id:'r1'}, {t:'led',x:600,y:140,id:'l'},
                    {t:'r',x:450,y:240,v:'100',id:'r2'}, {t:'buzz',x:600,y:240,id:'bz'},
                    {t:'gnd',x:320,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['mcu','pb0','r1','in','signal'],
                    ['mcu','pb1','r2','in','signal'], ['r1','out','l','a','signal']
                ]},

                { name: "LED Patterns (74HC595)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:200,y:180,id:'mcu'},
                    {t:'74595',x:380,y:160,id:'sr'}, {t:'led',x:550,y:100,id:'l1'},
                    {t:'led',x:550,y:160,id:'l2'}, {t:'led',x:550,y:220,id:'l3'},
                    {t:'led',x:550,y:280,id:'l4'}, {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['mcu','pb0','sr','data','signal'],
                    ['sr','q0','l1','a','signal'], ['sr','q1','l2','a','signal']
                ]},

                { name: "Servo Sweep Control", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'pot',x:180,y:280,v:'10k',id:'p'}, {t:'servo',x:500,y:180,id:'s'},
                    {t:'c',x:420,y:320,v:'100¬µF',id:'c'}, {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','mcu','vcc','power'], ['p','out','mcu','adc2','signal'],
                    ['mcu','pb0','s','sig','signal'], ['s','gnd','g','in','ground']
                ]},

                // Exp 9-32: Advanced ATtiny13 Projects
                { name: "Audio Level Meter", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:220,y:180,id:'mcu'},
                    {t:'74595',x:400,y:160,id:'sr'},
                    {t:'led',x:560,y:100,id:'l1'}, {t:'led',x:560,y:140,id:'l2'},
                    {t:'led',x:560,y:180,id:'l3'}, {t:'led',x:560,y:220,id:'l4'},
                    {t:'led',x:560,y:260,id:'l5'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','sr','data','signal'], ['sr','q0','l1','a','signal']]},

                { name: "Smart Battery Monitor", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'r',x:180,y:120,v:'20k',id:'r1'}, {t:'r',x:180,y:260,v:'10k',id:'r2'},
                    {t:'led',x:480,y:120,id:'l1'}, {t:'led',x:480,y:200,id:'l2'},
                    {t:'led',x:480,y:280,id:'l3'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','l1','a','signal'], ['mcu','pb1','l2','a','signal']]},

                { name: "Multi-Threshold Alarm", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:260,y:180,id:'mcu'},
                    {t:'ldr',x:160,y:100,id:'ldr'}, {t:'pir',x:160,y:260,id:'pir'},
                    {t:'r',x:460,y:180,v:'100',id:'r'}, {t:'buzz',x:610,y:180,id:'bz'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['ldr','out','mcu','adc2','signal'], ['pir','out','mcu','pb2','signal']]},

                { name: "Digital Logic Simulator", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'btn',x:140,y:100,id:'btn1'}, {t:'btn',x:140,y:160,id:'btn2'},
                    {t:'led',x:480,y:100,id:'l1'}, {t:'led',x:480,y:160,id:'l2'},
                    {t:'led',x:480,y:220,id:'l3'}, {t:'led',x:480,y:280,id:'l4'},
                    {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[['btn1','out','mcu','pb2','signal'], ['mcu','pb0','l1','a','signal']]},

                { name: "Multi-Point Temperature Monitor", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'lm35',x:460,y:100,id:'tmp1'}, {t:'lm35',x:460,y:200,id:'tmp2'},
                    {t:'oled',x:600,y:150,id:'disp'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['tmp1','out','mcu','adc2','signal'], ['tmp2','out','mcu','adc3','signal']]},

                { name: "Capacitive Touch Sensor", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:280,y:180,id:'mcu'},
                    {t:'touch',x:160,y:100,id:'tp'}, {t:'r',x:480,y:180,v:'220',id:'r'},
                    {t:'led',x:630,y:180,id:'l'}, {t:'c',x:420,y:280,v:'100pF',id:'c'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['tp','out','mcu','pb2','signal'], ['mcu','pb0','r','in','signal']]},

                { name: "Data Logger (EEPROM)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:260,y:180,id:'mcu'},
                    {t:'dht11',x:460,y:140,id:'dht'}, {t:'btn',x:140,y:100,id:'btn'},
                    {t:'led',x:500,y:260,id:'l'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['dht','data','mcu','pb3','signal'], ['btn','out','mcu','pb2','signal']]},

                { name: "7-Segment Display Counter", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:220,y:180,id:'mcu'},
                    {t:'74595',x:400,y:160,id:'sr'}, {t:'oled',x:580,y:160,id:'seg'},
                    {t:'btn',x:140,y:100,id:'btn'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','sr','data','signal'], ['sr','q0','seg','sda','signal']]},

                { name: "PWM Motor Speed Control", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'pot',x:160,y:100,v:'10k',id:'p'}, {t:'trans',x:440,y:180,id:'q'},
                    {t:'motor',x:600,y:180,id:'m'}, {t:'diode',x:550,y:280,id:'d'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['p','out','mcu','adc2','signal'], ['mcu','pb0','q','b','signal']]},

                { name: "Servo Robot Arm (2-axis)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'servo',x:480,y:120,id:'s1'}, {t:'servo',x:480,y:240,id:'s2'},
                    {t:'pot',x:160,y:100,v:'10k',id:'p1'}, {t:'pot',x:160,y:180,v:'10k',id:'p2'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','s1','sig','signal'], ['mcu','pb1','s2','sig','signal']]},

                { name: "Stepper Motor Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:220,y:180,id:'mcu'},
                    {t:'74595',x:400,y:160,id:'sr'}, {t:'motor',x:600,y:160,id:'m'},
                    {t:'btn',x:140,y:100,id:'btn'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','sr','data','signal'], ['sr','q0','m','in','signal']]},

                { name: "Smart Relay Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'ldr',x:160,y:100,id:'ldr'}, {t:'trans',x:460,y:180,id:'q'},
                    {t:'r',x:580,y:180,v:'220',id:'r'}, {t:'led',x:700,y:180,id:'l'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['ldr','out','mcu','adc2','signal'], ['mcu','pb0','q','b','signal']]},

                { name: "RGB LED Color Mixer", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:200,y:180,id:'mcu'},
                    {t:'pot',x:120,y:100,v:'10k',id:'p1'}, {t:'pot',x:120,y:160,v:'10k',id:'p2'},
                    {t:'pot',x:120,y:220,v:'10k',id:'p3'},
                    {t:'led',x:480,y:120,id:'l1'}, {t:'led',x:480,y:180,id:'l2'},
                    {t:'led',x:480,y:240,id:'l3'}, {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[['mcu','pb0','l1','a','signal'], ['mcu','pb1','l2','a','signal']]},

                { name: "IR Remote Control Decoder", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:260,y:180,id:'mcu'},
                    {t:'r',x:480,y:120,v:'220',id:'r1'}, {t:'led',x:630,y:120,id:'l1'},
                    {t:'r',x:480,y:200,v:'220',id:'r2'}, {t:'led',x:630,y:200,id:'l2'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb2','mcu','pb0','signal'], ['mcu','pb0','r1','in','signal']]},

                { name: "Ultrasonic Distance Sensor (HC-SR04)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'ultra',x:460,y:160,id:'us'}, {t:'oled',x:640,y:180,id:'disp'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['mcu','pb0','us','trig','signal'], ['us','echo','mcu','pb1','signal']]},

                { name: "Smart Fan Controller (Temp-based)", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'lm35',x:160,y:100,id:'tmp'}, {t:'trans',x:460,y:180,id:'q'},
                    {t:'motor',x:620,y:180,id:'m'}, {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['tmp','out','mcu','adc2','signal'], ['mcu','pb0','q','b','signal']]},

                { name: "MIDI Note Generator", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'btn',x:140,y:100,id:'btn1'}, {t:'btn',x:140,y:160,id:'btn2'},
                    {t:'btn',x:140,y:220,id:'btn3'}, {t:'btn',x:140,y:280,id:'btn4'},
                    {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[['btn1','out','mcu','pb2','signal'], ['btn2','out','mcu','pb3','signal']]},

                { name: "Simon Says Memory Game", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:200,y:180,id:'mcu'},
                    {t:'btn',x:120,y:80,id:'btn1'}, {t:'btn',x:120,y:140,id:'btn2'},
                    {t:'btn',x:120,y:200,id:'btn3'}, {t:'btn',x:120,y:260,id:'btn4'},
                    {t:'led',x:440,y:80,id:'l1'}, {t:'led',x:440,y:140,id:'l2'},
                    {t:'led',x:440,y:200,id:'l3'}, {t:'led',x:440,y:260,id:'l4'},
                    {t:'buzz',x:600,y:170,id:'bz'}, {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[['mcu','pb0','l1','a','signal'], ['btn1','out','mcu','pb2','signal']]},

                { name: "Digital Combination Lock", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'btn',x:140,y:80,id:'btn1'}, {t:'btn',x:140,y:140,id:'btn2'},
                    {t:'btn',x:140,y:200,id:'btn3'}, {t:'btn',x:140,y:260,id:'btn4'},
                    {t:'servo',x:500,y:180,id:'s'}, {t:'led',x:640,y:180,id:'l'},
                    {t:'gnd',x:320,y:420,id:'g'}
                ], wires:[['mcu','pb0','s','sig','signal'], ['mcu','pb1','l','a','signal']]},

                { name: "Wireless Temperature Transmitter", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:240,y:180,id:'mcu'},
                    {t:'lm35',x:160,y:100,id:'tmp'}, {t:'led',x:500,y:180,id:'l'},
                    {t:'gnd',x:320,y:400,id:'g'}
                ], wires:[['tmp','out','mcu','adc2','signal'], ['mcu','pb0','l','a','signal']]},

                { name: "Solar Battery Charger Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:220,y:180,id:'mcu'},
                    {t:'r',x:140,y:100,v:'10k',id:'r1'}, {t:'r',x:140,y:200,v:'10k',id:'r2'},
                    {t:'trans',x:440,y:180,id:'q'}, {t:'led',x:600,y:180,id:'l'},
                    {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[['mcu','pb0','q','b','signal'], ['mcu','pb1','l','a','signal']]},

                { name: "Line-Following Robot", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:200,y:180,id:'mcu'},
                    {t:'motor',x:480,y:120,id:'m1'}, {t:'motor',x:480,y:240,id:'m2'},
                    {t:'trans',x:380,y:180,id:'q1'}, {t:'trans',x:580,y:180,id:'q2'},
                    {t:'gnd',x:300,y:420,id:'g'}
                ], wires:[['mcu','pb0','q1','b','signal'], ['mcu','pb1','q2','b','signal']]},

                { name: "Smart Home Light Controller", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:220,y:180,id:'mcu'},
                    {t:'ldr',x:140,y:100,id:'ldr'}, {t:'pir',x:140,y:260,id:'pir'},
                    {t:'trans',x:440,y:180,id:'q'}, {t:'led',x:600,y:180,id:'l'},
                    {t:'gnd',x:300,y:400,id:'g'}
                ], wires:[['ldr','out','mcu','adc2','signal'], ['mcu','pb0','q','b','signal']]},

                { name: "Complete Weather Station", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'attiny',x:180,y:180,id:'mcu'},
                    {t:'lm35',x:380,y:100,id:'tmp'}, {t:'ldr',x:380,y:180,id:'ldr'},
                    {t:'oled',x:580,y:140,id:'disp'}, {t:'buzz',x:580,y:240,id:'bz'},
                    {t:'gnd',x:280,y:420,id:'g'}
                ], wires:[['tmp','out','mcu','adc2','signal'], ['ldr','out','mcu','adc3','signal']]}
            ],

            // Course 2: ESP8266 (32 experiments)
            2: [
                { name: "WiFi Blink - Web Control", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'r',x:480,y:220,v:'220',id:'r'}, {t:'led',x:630,y:220,id:'l'},
                    {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d1','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground'],
                    ['esp','gnd','g','in','ground']
                ]},

                { name: "WiFi Network Scanner", comps: [
                    {t:'bat',x:150,y:200,id:'b'}, {t:'esp',x:350,y:200,id:'esp'},
                    {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','gnd','g','in','ground']
                ]},

                { name: "Temperature Webserver", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'dht11',x:450,y:160,id:'dht'}, {t:'r',x:450,y:280,v:'10k',id:'r'},
                    {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d4','dht','data','signal'],
                    ['dht','vcc','esp','vcc','power'], ['dht','gnd','g','in','ground']
                ]},

                { name: "Remote DHT11 Monitor", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'dht11',x:450,y:160,id:'dht'}, {t:'oled',x:550,y:280,id:'disp'},
                    {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d4','dht','data','signal'],
                    ['esp','d1','disp','sda','signal'], ['esp','d2','disp','scl','signal']
                ]},

                { name: "JSON API Server", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'r',x:450,y:180,v:'220',id:'r1'}, {t:'led',x:600,y:140,id:'l1'},
                    {t:'r',x:450,y:260,v:'220',id:'r2'}, {t:'led',x:600,y:260,id:'l2'},
                    {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d1','r1','in','signal'],
                    ['esp','d2','r2','in','signal'], ['r1','out','l1','a','signal']
                ]},

                { name: "AJAX Real-time Dashboard", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'dht11',x:450,y:140,id:'dht'}, {t:'ldr',x:450,y:240,id:'ldr'},
                    {t:'r',x:550,y:240,v:'10k',id:'r'}, {t:'gnd',x:350,y:400,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d4','dht','data','signal'],
                    ['esp','a0','ldr','out','signal'], ['ldr','in','esp','vcc','power']
                ]},

                { name: "OTA Updates System", comps: [
                    {t:'bat',x:150,y:200,id:'b'}, {t:'esp',x:350,y:200,id:'esp'},
                    {t:'led',x:550,y:200,id:'l'}, {t:'r',x:480,y:200,v:'220',id:'r'},
                    {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['esp','d5','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                { name: "MQTT Pub/Sub Client", comps: [
                    {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:250,y:180,id:'esp'},
                    {t:'btn',x:150,y:100,id:'btn'}, {t:'r',x:450,y:200,v:'220',id:'r'},
                    {t:'led',x:600,y:200,id:'l'}, {t:'gnd',x:350,y:380,id:'g'}
                ], wires:[
                    ['b','pos','esp','vcc','power'], ['btn','out','esp','d2','signal'],
                    ['esp','d1','r','in','signal'], ['r','out','l','a','signal']
                ]},

                // Continue with remaining ESP8266 experiments
                ...Array.from({length:24}, (_, i) => ({
                    name: `Experiment ${9+i}`,
                    comps: [
                        {t:'bat',x:100,y:200,id:'b'}, {t:'esp',x:280,y:180,id:'esp'},
                        {t:'r',x:480,y:220,v:'220',id:'r'}, {t:'led',x:630,y:220,id:'l'},
                        {t:'gnd',x:350,y:380,id:'g'}
                    ],
                    wires: [
                        ['b','pos','esp','vcc','power'], ['esp','d1','r','in','signal'],
                        ['r','out','l','a','signal'], ['l','c','g','in','ground']
                    ]
                }))
            ],

            // Course 3: Raspberry Pi (32 experiments)
            3: [
                { name: "Hello Pi - LED Blink", comps: [
                    {t:'pi',x:200,y:180,id:'pi'}, {t:'r',x:450,y:220,v:'220',id:'r'},
                    {t:'led',x:600,y:220,id:'l'}, {t:'gnd',x:400,y:380,id:'g'}
                ], wires:[
                    ['pi','gpio18','r','in','signal'], ['r','out','l','a','signal'],
                    ['l','c','g','in','ground'], ['pi','gnd','g','in','ground']
                ]},

                { name: "Traffic Light Controller", comps: [
                    {t:'pi',x:150,y:180,id:'pi'}, {t:'r',x:400,y:100,v:'220',id:'r1'},
                    {t:'led',x:550,y:100,id:'l1'}, {t:'r',x:400,y:200,v:'220',id:'r2'},
                    {t:'led',x:550,y:200,id:'l2'}, {t:'r',x:400,y:300,v:'220',id:'r3'},
                    {t:'led',x:550,y:300,id:'l3'}, {t:'gnd',x:350,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio17','r1','in','signal'], ['r1','out','l1','a','signal'],
                    ['pi','gpio27','r2','in','signal'], ['r2','out','l2','a','signal'],
                    ['pi','gpio22','r3','in','signal'], ['r3','out','l3','a','signal'],
                    ['l1','c','g','in','ground'], ['l2','c','g','in','ground']
                ]},

                { name: "PWM Servo Control", comps: [
                    {t:'pi',x:200,y:200,id:'pi'}, {t:'servo',x:480,y:200,id:'s'},
                    {t:'pot',x:200,y:340,v:'10k',id:'p'}, {t:'gnd',x:380,y:380,id:'g'}
                ], wires:[
                    ['pi','gpio12','s','sig','signal'], ['pi','5v','s','vcc','power'],
                    ['s','gnd','g','in','ground'], ['pi','gnd','g','in','ground']
                ]},

                { name: "Button Input & Debounce", comps: [
                    {t:'pi',x:200,y:180,id:'pi'}, {t:'btn',x:100,y:100,id:'btn'},
                    {t:'r',x:180,y:100,v:'10k',id:'r1'}, {t:'r',x:450,y:220,v:'220',id:'r2'},
                    {t:'led',x:600,y:220,id:'l'}, {t:'gnd',x:380,y:380,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio18','r2','in','signal'],
                    ['r2','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                { name: "DHT11 Temp & Humidity", comps: [
                    {t:'pi',x:200,y:200,id:'pi'}, {t:'dht11',x:450,y:180,id:'dht'},
                    {t:'r',x:450,y:300,v:'10k',id:'r'}, {t:'gnd',x:380,y:400,id:'g'}
                ], wires:[
                    ['pi','3v3','dht','vcc','power'], ['pi','gpio4','dht','data','signal'],
                    ['dht','gnd','g','in','ground'], ['pi','gnd','g','in','ground']
                ]},

                { name: "Ultrasonic Distance Sensor", comps: [
                    {t:'pi',x:200,y:200,id:'pi'}, {t:'ultra',x:480,y:180,id:'us'},
                    {t:'r',x:620,y:240,v:'1k',id:'r1'}, {t:'r',x:620,y:320,v:'2k',id:'r2'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio23','us','trig','signal'], ['us','echo','r1','in','signal'],
                    ['r1','out','pi','gpio24','signal'], ['us','vcc','pi','5v','power']
                ]},

                { name: "PIR Motion Sensor", comps: [
                    {t:'pi',x:200,y:200,id:'pi'}, {t:'pir',x:420,y:160,id:'pir'},
                    {t:'r',x:550,y:260,v:'220',id:'r'}, {t:'led',x:680,y:260,id:'l'},
                    {t:'gnd',x:400,y:400,id:'g'}
                ], wires:[
                    ['pi','5v','pir','vcc','power'], ['pir','out','pi','gpio4','signal'],
                    ['pi','gpio18','r','in','signal'], ['r','out','l','a','signal']
                ]},

                { name: "MCP3008 ADC Integration", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'mcp3008',x:420,y:180,id:'adc'},
                    {t:'pot',x:600,y:140,v:'10k',id:'p1'}, {t:'ldr',x:600,y:240,id:'ldr'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','spi0','adc','clk','signal'], ['adc','ch0','p1','out','signal'],
                    ['adc','ch1','ldr','out','signal'], ['pi','3v3','adc','vref','power']
                ]},

                { name: "LCD 16x2 Display", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'oled',x:450,y:180,id:'lcd'},
                    {t:'pot',x:450,y:320,v:'10k',id:'p'}, {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio2','lcd','sda','signal'], ['pi','gpio3','lcd','scl','signal'],
                    ['pi','5v','lcd','vcc','power'], ['lcd','gnd','g','in','ground']
                ]},

                { name: "RGB LED Control", comps: [
                    {t:'pi',x:150,y:200,id:'pi'},
                    {t:'r',x:400,y:140,v:'220',id:'r1'}, {t:'led',x:550,y:140,id:'l1'},
                    {t:'r',x:400,y:220,v:'220',id:'r2'}, {t:'led',x:550,y:220,id:'l2'},
                    {t:'r',x:400,y:300,v:'220',id:'r3'}, {t:'led',x:550,y:300,id:'l3'},
                    {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio17','r1','in','signal'], ['r1','out','l1','a','signal'],
                    ['pi','gpio27','r2','in','signal'], ['r2','out','l2','a','signal'],
                    ['pi','gpio22','r3','in','signal'], ['r3','out','l3','a','signal']
                ]},

                { name: "7-Segment Display", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'74595',x:400,y:180,id:'sr'},
                    {t:'oled',x:600,y:180,id:'seg'}, {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio2','sr','data','signal'], ['sr','q0','seg','sda','signal'],
                    ['pi','3v3','sr','data','power'], ['sr','q1','seg','scl','signal']
                ]},

                { name: "NeoPixel LED Strip", comps: [
                    {t:'pi',x:180,y:200,id:'pi'},
                    {t:'led',x:450,y:140,id:'l1'}, {t:'led',x:550,y:140,id:'l2'},
                    {t:'led',x:650,y:140,id:'l3'}, {t:'led',x:450,y:240,id:'l4'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio18','l1','a','signal'], ['l1','c','l2','a','signal'],
                    ['l2','c','l3','a','signal'], ['l3','c','l4','a','signal']
                ]},

                { name: "Serial UART Communication", comps: [
                    {t:'pi',x:200,y:200,id:'pi'}, {t:'esp',x:500,y:200,id:'dev'},
                    {t:'r',x:380,y:160,v:'1k',id:'r1'}, {t:'r',x:380,y:240,v:'2k',id:'r2'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio2','r1','in','signal'], ['r1','out','dev','d1','signal'],
                    ['dev','d2','pi','gpio3','signal'], ['pi','gnd','g','in','ground']
                ]},

                { name: "SPI Communication", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'mcp3008',x:480,y:200,id:'spi'},
                    {t:'pot',x:650,y:200,v:'10k',id:'p'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','spi0','spi','clk','signal'], ['spi','ch0','p','out','signal'],
                    ['pi','3v3','spi','vref','power'], ['spi','gnd','g','in','ground']
                ]},

                { name: "I2C Bus Scanner", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'oled',x:450,y:160,id:'dev1'},
                    {t:'dht11',x:450,y:280,id:'dev2'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio2','dev1','sda','signal'], ['pi','gpio3','dev1','scl','signal'],
                    ['pi','gpio2','dev2','data','signal'], ['pi','3v3','dev1','vcc','power']
                ]},

                { name: "Data Logging SQLite", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'dht11',x:450,y:160,id:'dht'},
                    {t:'oled',x:600,y:280,id:'lcd'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['pi','gpio2','lcd','sda','signal'],
                    ['dht','vcc','pi','3v3','power'], ['lcd','gnd','g','in','ground']
                ]},

                { name: "Pi Camera Module", comps: [
                    {t:'pi',x:200,y:200,id:'pi'},
                    {t:'r',x:450,y:200,v:'220',id:'r'}, {t:'led',x:600,y:200,id:'l'},
                    {t:'btn',x:100,y:100,id:'btn'}, {t:'gnd',x:400,y:400,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio18','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                { name: "Face Detection OpenCV", comps: [
                    {t:'pi',x:180,y:200,id:'pi'},
                    {t:'r',x:450,y:180,v:'220',id:'r1'}, {t:'led',x:600,y:180,id:'l1'},
                    {t:'buzz',x:600,y:280,id:'bz'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio17','r1','in','signal'], ['r1','out','l1','a','signal'],
                    ['pi','gpio27','bz','in','signal'], ['bz','out','g','in','ground']
                ]},

                { name: "QR Code Scanner", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'btn',x:100,y:120,id:'btn'},
                    {t:'oled',x:500,y:200,id:'lcd'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio3','lcd','sda','signal'],
                    ['pi','gpio4','lcd','scl','signal'], ['pi','3v3','lcd','vcc','power']
                ]},

                { name: "Motion Detection Camera", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'pir',x:420,y:140,id:'pir'},
                    {t:'r',x:520,y:260,v:'220',id:'r'}, {t:'led',x:650,y:260,id:'l'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','5v','pir','vcc','power'], ['pir','out','pi','gpio4','signal'],
                    ['pi','gpio18','r','in','signal'], ['r','out','l','a','signal']
                ]},

                { name: "Object Tracking", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'servo',x:480,y:160,id:'s1'},
                    {t:'servo',x:480,y:280,id:'s2'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio12','s1','sig','signal'], ['pi','gpio13','s2','sig','signal'],
                    ['pi','5v','s1','vcc','power'], ['pi','5v','s2','vcc','power']
                ]},

                { name: "OCR Text Recognition", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'btn',x:100,y:120,id:'btn'},
                    {t:'oled',x:520,y:200,id:'lcd'}, {t:'buzz',x:520,y:320,id:'bz'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio3','lcd','sda','signal'],
                    ['pi','gpio17','bz','in','signal'], ['bz','out','g','in','ground']
                ]},

                { name: "TensorFlow Lite Setup", comps: [
                    {t:'pi',x:180,y:200,id:'pi'},
                    {t:'r',x:450,y:180,v:'220',id:'r'}, {t:'led',x:600,y:180,id:'l'},
                    {t:'oled',x:500,y:300,id:'lcd'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio18','r','in','signal'], ['r','out','l','a','signal'],
                    ['pi','gpio2','lcd','sda','signal'], ['pi','gpio3','lcd','scl','signal']
                ]},

                { name: "Image Classification", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'btn',x:80,y:120,id:'btn'},
                    {t:'oled',x:480,y:160,id:'lcd'},
                    {t:'r',x:480,y:280,v:'220',id:'r1'}, {t:'led',x:630,y:280,id:'l1'},
                    {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio3','lcd','sda','signal'],
                    ['pi','gpio18','r1','in','signal'], ['r1','out','l1','a','signal']
                ]},

                { name: "Voice Recognition", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'spk',x:480,y:160,id:'spk'},
                    {t:'r',x:480,y:280,v:'220',id:'r'}, {t:'led',x:630,y:280,id:'l'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio18','spk','in','signal'], ['pi','gpio17','r','in','signal'],
                    ['r','out','l','a','signal'], ['l','c','g','in','ground']
                ]},

                { name: "Speech Synthesis", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'spk',x:480,y:200,id:'spk'},
                    {t:'btn',x:100,y:120,id:'btn'}, {t:'gnd',x:400,y:400,id:'g'}
                ], wires:[
                    ['pi','gpio18','spk','in','signal'], ['btn','out','pi','gpio2','signal'],
                    ['spk','out','g','in','ground'], ['pi','gnd','g','in','ground']
                ]},

                { name: "Gesture Control", comps: [
                    {t:'pi',x:150,y:200,id:'pi'},
                    {t:'r',x:400,y:140,v:'220',id:'r1'}, {t:'led',x:550,y:140,id:'l1'},
                    {t:'r',x:400,y:220,v:'220',id:'r2'}, {t:'led',x:550,y:220,id:'l2'},
                    {t:'servo',x:480,y:320,id:'s'}, {t:'gnd',x:380,y:440,id:'g'}
                ], wires:[
                    ['pi','gpio17','r1','in','signal'], ['r1','out','l1','a','signal'],
                    ['pi','gpio27','r2','in','signal'], ['pi','gpio12','s','sig','signal']
                ]},

                { name: "Flask Web Server", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'dht11',x:450,y:160,id:'dht'},
                    {t:'r',x:520,y:280,v:'220',id:'r'}, {t:'led',x:670,y:280,id:'l'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['pi','gpio18','r','in','signal'],
                    ['r','out','l','a','signal'], ['dht','vcc','pi','3v3','power']
                ]},

                { name: "REST API Server", comps: [
                    {t:'pi',x:180,y:200,id:'pi'},
                    {t:'r',x:450,y:160,v:'220',id:'r1'}, {t:'led',x:600,y:160,id:'l1'},
                    {t:'r',x:450,y:240,v:'220',id:'r2'}, {t:'led',x:600,y:240,id:'l2'},
                    {t:'btn',x:100,y:120,id:'btn'}, {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['btn','out','pi','gpio2','signal'], ['pi','gpio17','r1','in','signal'],
                    ['pi','gpio27','r2','in','signal'], ['r1','out','l1','a','signal']
                ]},

                { name: "Socket.IO Real-time", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'dht11',x:450,y:160,id:'dht'},
                    {t:'ldr',x:450,y:280,id:'ldr'}, {t:'r',x:550,y:280,v:'10k',id:'r'},
                    {t:'gnd',x:400,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['ldr','out','r','in','signal'],
                    ['dht','vcc','pi','3v3','power'], ['r','out','g','in','ground']
                ]},

                { name: "Telegram Bot Interface", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'btn',x:80,y:120,id:'btn1'},
                    {t:'btn',x:80,y:180,id:'btn2'},
                    {t:'r',x:450,y:180,v:'220',id:'r'}, {t:'led',x:600,y:180,id:'l'},
                    {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['btn1','out','pi','gpio2','signal'], ['btn2','out','pi','gpio3','signal'],
                    ['pi','gpio18','r','in','signal'], ['r','out','l','a','signal']
                ]},

                { name: "MQTT IoT Gateway", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'dht11',x:420,y:140,id:'dht'},
                    {t:'pir',x:420,y:260,id:'pir'}, {t:'buzz',x:600,y:200,id:'bz'},
                    {t:'gnd',x:380,y:420,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['pi','gpio17','pir','out','signal'],
                    ['pi','gpio27','bz','in','signal'], ['bz','out','g','in','ground']
                ]},

                { name: "Complete Weather Station", comps: [
                    {t:'pi',x:150,y:180,id:'pi'}, {t:'dht11',x:400,y:120,id:'dht'},
                    {t:'ldr',x:400,y:220,id:'ldr'}, {t:'r',x:500,y:220,v:'10k',id:'r1'},
                    {t:'oled',x:580,y:300,id:'lcd'}, {t:'gnd',x:380,y:440,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['ldr','out','r1','in','signal'],
                    ['pi','gpio2','lcd','sda','signal'], ['pi','gpio3','lcd','scl','signal']
                ]},

                { name: "Smart Home Hub", comps: [
                    {t:'pi',x:120,y:200,id:'pi'},
                    {t:'r',x:380,y:120,v:'220',id:'r1'}, {t:'led',x:530,y:120,id:'l1'},
                    {t:'r',x:380,y:200,v:'220',id:'r2'}, {t:'led',x:530,y:200,id:'l2'},
                    {t:'servo',x:450,y:300,id:'s'}, {t:'buzz',x:630,y:300,id:'bz'},
                    {t:'gnd',x:350,y:440,id:'g'}
                ], wires:[
                    ['pi','gpio17','r1','in','signal'], ['pi','gpio27','r2','in','signal'],
                    ['pi','gpio12','s','sig','signal'], ['pi','gpio22','bz','in','signal']
                ]},

                { name: "Air Quality Monitor", comps: [
                    {t:'pi',x:180,y:200,id:'pi'}, {t:'mcp3008',x:450,y:160,id:'adc'},
                    {t:'oled',x:600,y:280,id:'lcd'}, {t:'buzz',x:450,y:340,id:'bz'},
                    {t:'gnd',x:400,y:440,id:'g'}
                ], wires:[
                    ['pi','spi0','adc','clk','signal'], ['pi','gpio2','lcd','sda','signal'],
                    ['pi','gpio17','bz','in','signal'], ['bz','out','g','in','ground']
                ]},

                { name: "Security Camera System", comps: [
                    {t:'pi',x:150,y:200,id:'pi'}, {t:'pir',x:400,y:140,id:'pir1'},
                    {t:'pir',x:400,y:260,id:'pir2'}, {t:'buzz',x:580,y:200,id:'bz'},
                    {t:'r',x:580,y:320,v:'220',id:'r'}, {t:'led',x:720,y:320,id:'l'},
                    {t:'gnd',x:380,y:440,id:'g'}
                ], wires:[
                    ['pi','gpio4','pir1','out','signal'], ['pi','gpio17','pir2','out','signal'],
                    ['pi','gpio27','bz','in','signal'], ['pi','gpio18','r','in','signal']
                ]},

                { name: "Robot Car Controller", comps: [
                    {t:'pi',x:150,y:200,id:'pi'},
                    {t:'motor',x:450,y:140,id:'m1'}, {t:'motor',x:450,y:260,id:'m2'},
                    {t:'ultra',x:620,y:180,id:'us'}, {t:'gnd',x:380,y:440,id:'g'}
                ], wires:[
                    ['pi','gpio17','m1','in','signal'], ['pi','gpio27','m2','in','signal'],
                    ['pi','gpio23','us','trig','signal'], ['us','echo','pi','gpio24','signal']
                ]},

                { name: "IoT Dashboard Complete", comps: [
                    {t:'pi',x:120,y:180,id:'pi'}, {t:'dht11',x:380,y:120,id:'dht'},
                    {t:'ldr',x:380,y:200,id:'ldr'}, {t:'r',x:480,y:200,v:'10k',id:'r1'},
                    {t:'pir',x:380,y:280,id:'pir'}, {t:'oled',x:600,y:180,id:'lcd'},
                    {t:'r',x:600,y:320,v:'220',id:'r2'}, {t:'led',x:720,y:320,id:'l'},
                    {t:'gnd',x:380,y:460,id:'g'}
                ], wires:[
                    ['pi','gpio4','dht','data','signal'], ['ldr','out','r1','in','signal'],
                    ['pi','gpio17','pir','out','signal'], ['pi','gpio2','lcd','sda','signal'],
                    ['pi','gpio18','r2','in','signal'], ['r2','out','l','a','signal']
                ]}
            ]
        };

        // Component templates with visible pins and leads
        const compHTML = {
            bat: (v) => `<div class="battery-body">${v||'9V'}
                <div class="pin-dot" style="position:absolute;top:-4px;left:50%;transform:translateX(-50%);width:8px;height:8px;background:#e74c3c;border-radius:50%;border:2px solid #fff"></div>
                <div class="pin-dot" style="position:absolute;bottom:-4px;left:50%;transform:translateX(-50%);width:8px;height:8px;background:#2c3e50;border-radius:50%;border:2px solid #fff"></div>
                <div class="comp-label">Battery</div></div>`,

            r: (v) => `<div style="position:relative;width:80px;height:30px">
                <div style="position:absolute;left:0;top:12px;width:10px;height:3px;background:#D2691E"></div>
                <div class="resistor-body" style="position:absolute;left:10px;top:2.5px">${v||'220Œ©'}</div>
                <div style="position:absolute;right:0;top:12px;width:10px;height:3px;background:#D2691E"></div>
                <div class="pin-dot" style="position:absolute;left:-2px;top:11px;width:6px;height:6px;background:#D2691E;border-radius:50%"></div>
                <div class="pin-dot" style="position:absolute;right:-2px;top:11px;width:6px;height:6px;background:#D2691E;border-radius:50%"></div>
            </div>`,

            led: () => `<div style="position:relative;width:40px;height:50px">
                <div class="led-body" style="position:absolute;top:5px"></div>
                <div style="position:absolute;left:12px;top:0;width:2px;height:8px;background:#999"></div>
                <div style="position:absolute;left:26px;top:0;width:2px;height:8px;background:#999"></div>
                <div class="pin-dot" style="position:absolute;left:10px;top:-3px;width:6px;height:6px;background:#ff6b6b;border-radius:50%"></div>
                <div class="pin-dot" style="position:absolute;left:24px;top:-3px;width:6px;height:6px;background:#666;border-radius:50%"></div>
            </div>`,

            c: (v) => `<div style="position:relative;width:50px;height:35px">
                <div class="cap-body" style="position:absolute;left:10px;top:5px"><div class="cap-plate"></div><div class="cap-plate"></div></div>
                <div style="position:absolute;left:0;top:16px;width:18px;height:2px;background:#666"></div>
                <div style="position:absolute;right:0;top:16px;width:18px;height:2px;background:#666"></div>
                <div class="pin-dot" style="position:absolute;left:-2px;top:15px;width:6px;height:6px;background:#e74c3c;border-radius:50%"></div>
                <div class="pin-dot" style="position:absolute;right:-2px;top:15px;width:6px;height:6px;background:#666;border-radius:50%"></div>
                <div class="comp-label">${v||'100¬µF'}</div>
            </div>`,

            gnd: () => `<div class="ground-body"><div class="pin-dot" style="position:absolute;top:-4px;left:50%;transform:translateX(-50%);width:8px;height:8px;background:#2c3e50;border-radius:50%;border:2px solid #fff"></div><div class="ground-line" style="width:40px"></div><div class="ground-line" style="width:28px"></div><div class="ground-line" style="width:16px"></div><div class="comp-label">GND</div></div>`,

            '555': () => `<div class="ic-body" style="position:relative;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 1 GND"></div>
                <div style="position:absolute;left:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 2 TRIG"></div>
                <div style="position:absolute;left:-6px;top:45%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 3 OUT"></div>
                <div style="position:absolute;left:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 4 RST"></div>
                <div style="position:absolute;right:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 5 CV"></div>
                <div style="position:absolute;right:-6px;top:45%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 6 THR"></div>
                <div style="position:absolute;right:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 7 DIS"></div>
                <div style="position:absolute;right:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Pin 8 VCC"></div>
                <div style="font-weight:bold;font-size:16px">555</div><div style="font-size:10px;margin-top:3px">Timer</div>
            </div>`,

            attiny: () => `<div class="ic-body" style="position:relative;background:#34495e;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB5/RST"></div>
                <div style="position:absolute;left:-6px;top:35%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB3/ADC3"></div>
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB4/ADC2"></div>
                <div style="position:absolute;left:-6px;top:65%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                <div style="position:absolute;right:-6px;top:65%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB0"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB1"></div>
                <div style="position:absolute;right:-6px;top:35%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="PB2"></div>
                <div style="position:absolute;right:-6px;top:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                ATtiny13<div style="font-size:9px">8-pin MCU</div>
            </div>`,

            esp: () => `<div class="ic-body" style="position:relative;width:140px;background:linear-gradient(135deg,#667eea,#764ba2);padding:30px 15px">
                <div style="position:absolute;right:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D0"></div>
                <div style="position:absolute;right:-6px;top:25%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D1"></div>
                <div style="position:absolute;right:-6px;top:35%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D2"></div>
                <div style="position:absolute;right:-6px;top:45%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D3"></div>
                <div style="position:absolute;right:-6px;top:55%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D4"></div>
                <div style="position:absolute;right:-6px;top:65%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="D5"></div>
                <div style="position:absolute;left:-6px;top:25%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="A0"></div>
                <div style="position:absolute;left:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;left:-6px;top:65%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                ESP8266<div style="font-size:9px">WiFi</div>
            </div>`,

            pi: () => `<div class="ic-body" style="position:relative;width:160px;height:100px;background:linear-gradient(135deg,#e74c3c,#c0392b);padding:15px">
                <div style="position:absolute;top:-6px;left:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="3.3V"></div>
                <div style="position:absolute;top:-6px;left:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO2"></div>
                <div style="position:absolute;top:-6px;left:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO3"></div>
                <div style="position:absolute;top:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO4"></div>
                <div style="position:absolute;top:-6px;left:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO17"></div>
                <div style="position:absolute;top:-6px;left:70%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO27"></div>
                <div style="position:absolute;right:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO22"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GPIO10"></div>
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                üçì Raspberry Pi<div style="font-size:9px">Linux SBC</div>
            </div>`,

            dht11: () => `<div class="ic-body" style="position:relative;background:#3498db;padding:20px 10px">
                <div style="position:absolute;top:-6px;left:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;top:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="DATA"></div>
                <div style="position:absolute;top:-6px;left:80%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                DHT11<div style="font-size:9px">Temp/Hum</div>
            </div>`,

            servo: () => `<div class="ic-body" style="position:relative;background:#34495e;padding:20px 10px">
                <div style="position:absolute;bottom:-6px;left:20%;width:6px;height:6px;background:#e74c3c;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="SIG"></div>
                <div style="position:absolute;bottom:-6px;left:80%;width:6px;height:6px;background:#2c3e50;border-radius:50%" title="GND"></div>
                SERVO<div style="font-size:9px">SG90</div>
            </div>`,

            btn: () => `<div style="position:relative;width:40px;height:50px">
                <div style="width:40px;height:40px;background:radial-gradient(circle,#e74c3c,#c0392b);border:3px solid #8b0000;border-radius:50%;position:absolute;top:5px"></div>
                <div class="pin-dot" style="position:absolute;left:17px;top:0;width:6px;height:6px;background:#999;border-radius:50%"></div>
                <div class="pin-dot" style="position:absolute;left:17px;bottom:0;width:6px;height:6px;background:#999;border-radius:50%"></div>
            </div>`,

            pot: (v) => `<div class="ic-body" style="background:#7f8c8d;width:60px;position:relative">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%"></div>
                POT<div style="font-size:9px">${v||'10k'}</div>
            </div>`,

            ldr: () => `<div class="ic-body" style="background:#f39c12;width:50px;position:relative">
                <div style="position:absolute;top:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)"></div>
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)"></div>
                LDR<div style="font-size:9px">Photo</div>
            </div>`,

            buzz: () => `<div class="ic-body" style="background:#2c3e50;width:60px;position:relative">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#e74c3c;border-radius:50%"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#2c3e50;border-radius:50%"></div>
                üîä<div style="font-size:9px">Buzzer</div>
            </div>`,

            spk: () => `<div class="ic-body" style="background:#34495e;width:70px;position:relative">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#e74c3c;border-radius:50%"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#2c3e50;border-radius:50%"></div>
                ‚ô™<div style="font-size:9px">Speaker</div>
            </div>`,

            trans: () => `<div class="ic-body" style="background:#95a5a6;width:50px;position:relative">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Base"></div>
                <div style="position:absolute;right:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Collector"></div>
                <div style="position:absolute;right:-6px;top:70%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Emitter"></div>
                Q<div style="font-size:9px">NPN</div>
            </div>`,

            motor: () => `<div class="ic-body" style="background:#7f8c8d;position:relative">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#e74c3c;border-radius:50%"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#2c3e50;border-radius:50%"></div>
                MOTOR<div style="font-size:9px">DC</div>
            </div>`,

            '4017': () => `<div class="ic-body" style="position:relative;padding:30px 15px">
                <div style="position:absolute;left:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%"></div>
                <div style="position:absolute;left:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%"></div>
                <div style="position:absolute;left:-6px;top:45%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="CLK"></div>
                <div style="position:absolute;left:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%"></div>
                <div style="position:absolute;right:-6px;top:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q0"></div>
                <div style="position:absolute;right:-6px;top:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q1"></div>
                <div style="position:absolute;right:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q2"></div>
                4017<div style="font-size:9px">Decade</div>
            </div>`,

            '74595': () => `<div class="ic-body" style="position:relative;padding:30px 15px">
                <div style="position:absolute;left:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="DATA"></div>
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="CLK"></div>
                <div style="position:absolute;right:-6px;top:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q0"></div>
                <div style="position:absolute;right:-6px;top:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q1"></div>
                <div style="position:absolute;right:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="Q2"></div>
                74HC595<div style="font-size:9px">Shift Reg</div>
            </div>`,

            lm358: () => `<div class="ic-body" style="position:relative;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="IN+"></div>
                <div style="position:absolute;left:-6px;top:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="IN-"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="OUT"></div>
                <div style="position:absolute;left:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;left:-6px;top:85%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                LM358<div style="font-size:9px">Op-Amp</div>
            </div>`,

            lm386: () => `<div class="ic-body" style="position:relative;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="IN"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="OUT"></div>
                <div style="position:absolute;left:-6px;top:15%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;left:-6px;top:85%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                LM386<div style="font-size:9px">Audio</div>
            </div>`,

            lm317: () => `<div class="ic-body" style="position:relative;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="IN"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="OUT"></div>
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)" title="ADJ"></div>
                LM317<div style="font-size:9px">Reg</div>
            </div>`,

            lm35: () => `<div class="ic-body" style="background:#e67e22;position:relative;padding:20px 10px">
                <div style="position:absolute;left:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="OUT"></div>
                <div style="position:absolute;left:-6px;top:70%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                LM35<div style="font-size:9px">Temp</div>
            </div>`,

            touch: () => `<div class="ic-body" style="background:#9b59b6;width:60px;position:relative">
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)"></div>
                TOUCH<div style="font-size:9px">Pad</div>
            </div>`,

            rain: () => `<div class="ic-body" style="background:#3498db;position:relative">
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)"></div>
                RAIN<div style="font-size:9px">Sensor</div>
            </div>`,

            diode: () => `<div style="position:relative;width:60px;height:25px">
                <div style="position:absolute;left:0;top:10px;width:10px;height:3px;background:#888"></div>
                <div style="width:40px;height:20px;background:linear-gradient(to right,#888,#666);border-radius:10px;position:absolute;left:10px;top:2px"></div>
                <div style="position:absolute;right:0;top:10px;width:10px;height:3px;background:#666"></div>
                <div class="pin-dot" style="position:absolute;left:-2px;top:9px;width:6px;height:6px;background:#888;border-radius:50%"></div>
                <div class="pin-dot" style="position:absolute;right:-2px;top:9px;width:6px;height:6px;background:#666;border-radius:50%"></div>
            </div>`,

            oled: () => `<div class="ic-body" style="background:#1abc9c;width:100px;position:relative">
                <div style="position:absolute;bottom:-6px;left:20%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;bottom:-6px;left:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                <div style="position:absolute;bottom:-6px;left:60%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="SDA"></div>
                <div style="position:absolute;bottom:-6px;left:80%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="SCL"></div>
                OLED<div style="font-size:9px">128x64</div>
            </div>`,

            ultra: () => `<div class="ic-body" style="background:#16a085;position:relative;padding:20px 10px">
                <div style="position:absolute;bottom:-6px;left:25%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;bottom:-6px;left:45%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="TRIG"></div>
                <div style="position:absolute;bottom:-6px;left:65%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="ECHO"></div>
                <div style="position:absolute;bottom:-6px;left:85%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                HC-SR04<div style="font-size:9px">Ultrasonic</div>
            </div>`,

            pir: () => `<div class="ic-body" style="background:#8e44ad;position:relative;padding:20px 10px">
                <div style="position:absolute;bottom:-6px;left:25%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;bottom:-6px;left:55%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="OUT"></div>
                <div style="position:absolute;bottom:-6px;left:85%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="GND"></div>
                PIR<div style="font-size:9px">Motion</div>
            </div>`,

            mcp3008: () => `<div class="ic-body" style="background:#2980b9;position:relative;padding:25px 15px">
                <div style="position:absolute;left:-6px;top:25%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="CH0"></div>
                <div style="position:absolute;left:-6px;top:40%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="CH1"></div>
                <div style="position:absolute;right:-6px;top:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="CLK"></div>
                <div style="position:absolute;right:-6px;top:50%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="DOUT"></div>
                <div style="position:absolute;top:-6px;left:30%;width:6px;height:6px;background:#ffd700;border-radius:50%" title="VCC"></div>
                <div style="position:absolute;bottom:-6px;left:50%;width:6px;height:6px;background:#ffd700;border-radius:50%;transform:translateX(-50%)" title="GND"></div>
                MCP3008<div style="font-size:9px">ADC</div>
            </div>`
        };

        // Connection points for each component
        const connPoints = {
            bat: {pos:{dx:0.5,dy:0}, neg:{dx:0.5,dy:1}},
            r: {in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}},
            led: {a:{dx:0.3,dy:1}, c:{dx:0.7,dy:1}},
            c: {pos:{dx:0,dy:0.5}, neg:{dx:1,dy:0.5}},
            gnd: {in:{dx:0.5,dy:0}},
            '555': {vcc:{dx:0.1,dy:0}, gnd:{dx:0.1,dy:1}, out:{dx:1,dy:0.5}, trig:{dx:0,dy:0.3}, cv:{dx:0.5,dy:1}},
            attiny: {vcc:{dx:0.5,dy:0}, gnd:{dx:0.5,dy:1}, pb0:{dx:1,dy:0.3}, pb1:{dx:1,dy:0.5}, pb2:{dx:1,dy:0.7}, adc2:{dx:0,dy:0.5}},
            esp: {vcc:{dx:0.1,dy:0}, gnd:{dx:0.1,dy:1}, d1:{dx:1,dy:0.3}, d2:{dx:1,dy:0.4}, d4:{dx:1,dy:0.6}, a0:{dx:0,dy:0.5}, spi0:{dx:0.8,dy:0}},
            pi: {gpio18:{dx:1,dy:0.3}, gpio17:{dx:1,dy:0.2}, gpio27:{dx:1,dy:0.4}, gpio22:{dx:1,dy:0.5}, gpio4:{dx:1,dy:0.6}, gpio2:{dx:1,dy:0.7}, gpio23:{dx:0.3,dy:0}, gpio24:{dx:0.5,dy:0}, gpio12:{dx:0.7,dy:0}, gnd:{dx:0.5,dy:1}, '3v3':{dx:0.2,dy:0}, '5v':{dx:0.8,dy:1}, spi0:{dx:0.9,dy:0}},
            dht11: {vcc:{dx:0.2,dy:0}, data:{dx:0.5,dy:0}, gnd:{dx:0.8,dy:0}},
            servo: {vcc:{dx:0.2,dy:1}, sig:{dx:0.5,dy:1}, gnd:{dx:0.8,dy:1}},
            btn: {out:{dx:0.5,dy:0}, in:{dx:0.5,dy:1}},
            pot: {out:{dx:1,dy:0.5}, in:{dx:0,dy:0.5}},
            ldr: {in:{dx:0.5,dy:0}, out:{dx:0.5,dy:1}},
            buzz: {in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}},
            spk: {in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}},
            trans: {b:{dx:0,dy:0.5}, c:{dx:1,dy:0.3}, e:{dx:1,dy:0.7}},
            motor: {in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}},
            '4017': {vcc:{dx:0.1,dy:0}, gnd:{dx:0.1,dy:1}, clk:{dx:0,dy:0.5}, q0:{dx:1,dy:0.2}, q1:{dx:1,dy:0.4}, q2:{dx:1,dy:0.6}},
            '74595': {data:{dx:0,dy:0.3}, clk:{dx:0,dy:0.5}, q0:{dx:1,dy:0.2}, q1:{dx:1,dy:0.4}, q2:{dx:1,dy:0.6}},
            lm358: {vcc:{dx:0.1,dy:0}, gnd:{dx:0.1,dy:1}, 'in+':{dx:0,dy:0.4}, 'in-':{dx:0,dy:0.6}, out:{dx:1,dy:0.5}},
            lm386: {vcc:{dx:0.1,dy:0}, gnd:{dx:0.1,dy:1}, in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}},
            lm317: {in:{dx:0,dy:0.5}, out:{dx:1,dy:0.5}, adj:{dx:0.5,dy:1}},
            lm35: {vcc:{dx:0.2,dy:0}, out:{dx:0.5,dy:1}, gnd:{dx:0.8,dy:0}},
            touch: {out:{dx:1,dy:0.5}},
            rain: {out:{dx:1,dy:0.5}},
            diode: {a:{dx:0,dy:0.5}, c:{dx:1,dy:0.5}},
            oled: {sda:{dx:0,dy:0.4}, scl:{dx:0,dy:0.6}, vcc:{dx:0.2,dy:0}, gnd:{dx:0.8,dy:0}},
            ultra: {vcc:{dx:0.2,dy:0}, trig:{dx:0.4,dy:0}, echo:{dx:0.6,dy:0}, gnd:{dx:0.8,dy:0}},
            pir: {vcc:{dx:0.3,dy:0}, out:{dx:0.5,dy:1}, gnd:{dx:0.7,dy:0}},
            mcp3008: {vref:{dx:0.1,dy:0}, clk:{dx:0.3,dy:0}, ch0:{dx:1,dy:0.3}, ch1:{dx:1,dy:0.5}, gnd:{dx:0.1,dy:1}}
        };

        let currentCourse = 0;
        let currentExpIdx = 0;
        let zoom = 1;
        let components = {};
        let draggedComponent = null;
        let dragOffset = { x: 0, y: 0 };

        document.addEventListener('DOMContentLoaded', () => {
            renderExperiments(0);
            setupEventListeners();
        });

        function renderExperiments(course) {
            const list = document.getElementById('experimentsList');
            list.innerHTML = '';

            circuits[course].forEach((circ, idx) => {
                const card = document.createElement('div');
                card.className = 'experiment-card';
                card.innerHTML = `
                    <div class="exp-number">Experiment ${idx + 1}</div>
                    <div class="exp-name">${circ.name}</div>
                `;
                card.onclick = () => loadCircuit(course, idx);
                list.appendChild(card);
            });
        }

        function loadCircuit(course, expIdx) {
            document.querySelectorAll('.experiment-card').forEach(c => c.classList.remove('active'));
            event.target.closest('.experiment-card').classList.add('active');

            currentCourse = course;
            currentExpIdx = expIdx;

            const circuit = circuits[course][expIdx];
            document.getElementById('circuitTitle').textContent = circuit.name;
            document.getElementById('circuitSubtitle').textContent = `Course ${course + 1} - Experiment ${expIdx + 1}`;

            // Generate components list
            generateComponentsList(circuit);

            // Generate assembly instructions
            generateInstructions(circuit);

            drawCircuit(circuit);
        }

        function generateComponentsList(circuit) {
            const compMap = {};
            const componentNames = {
                'bat': 'Battery', 'r': 'Resistor', 'led': 'LED', 'c': 'Capacitor',
                'gnd': 'Ground connection', '555': '555 Timer IC', 'attiny': 'ATtiny13 Microcontroller',
                'esp': 'ESP8266 WiFi Module', 'pi': 'Raspberry Pi', 'pot': 'Potentiometer',
                'btn': 'Push Button', 'buzz': 'Buzzer', 'spk': 'Speaker', 'servo': 'Servo Motor',
                'motor': 'DC Motor', 'trans': 'Transistor', 'diode': 'Diode', 'ldr': 'Light Sensor (LDR)',
                'dht11': 'DHT11 Temp/Humidity Sensor', 'lm358': 'LM358 Op-Amp IC', 'lm386': 'LM386 Audio Amp IC',
                'lm317': 'LM317 Voltage Regulator', 'lm35': 'LM35 Temperature Sensor', '4017': '4017 Decade Counter IC',
                '74595': '74HC595 Shift Register', 'oled': 'OLED Display', 'touch': 'Touch Sensor Pad',
                'pir': 'PIR Motion Sensor', 'ultra': 'HC-SR04 Ultrasonic Sensor', 'mcp3008': 'MCP3008 ADC',
                'rain': 'Rain Sensor'
            };

            circuit.comps.forEach(comp => {
                const name = componentNames[comp.t] || comp.t.toUpperCase();
                const key = comp.v ? `${name} (${comp.v})` : name;
                compMap[key] = (compMap[key] || 0) + 1;
            });

            let html = '<ul style="list-style: none; padding-left: 0; margin: 0;">';
            Object.entries(compMap).forEach(([name, count]) => {
                html += `<li style="padding: 4px 0; border-bottom: 1px solid #333;">
                    <span style="color: #667eea; font-weight: bold;">${count}x</span> ${name}
                </li>`;
            });
            html += '</ul>';

            document.getElementById('componentsList').innerHTML = html;
        }

        function generateInstructions(circuit) {
            const componentNames = {
                'bat': 'battery', 'r': 'resistor', 'led': 'LED', 'c': 'capacitor',
                'gnd': 'ground rail', '555': '555 timer', 'attiny': 'ATtiny13',
                'esp': 'ESP8266', 'pi': 'Raspberry Pi', 'pot': 'potentiometer',
                'btn': 'button', 'buzz': 'buzzer', 'spk': 'speaker', 'servo': 'servo',
                'motor': 'motor', 'trans': 'transistor', 'diode': 'diode', 'ldr': 'LDR',
                'dht11': 'DHT11 sensor', 'lm358': 'LM358', 'lm386': 'LM386',
                'lm317': 'LM317', 'lm35': 'LM35', '4017': '4017 counter',
                '74595': '74HC595', 'oled': 'OLED display', 'touch': 'touch pad',
                'pir': 'PIR sensor', 'ultra': 'ultrasonic sensor', 'mcp3008': 'MCP3008'
            };

            let html = '<ol style="padding-left: 20px; margin: 0;">';

            // Step 1: Power setup
            html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Power Setup:</strong> Connect the battery/power supply to the breadboard rails</li>';

            // Step 2: Place main components
            const mainComps = circuit.comps.filter(c => ['555','attiny','esp','pi','lm358','lm386','lm317','4017','74595'].includes(c.t));
            if (mainComps.length > 0) {
                html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Main ICs:</strong> Insert ';
                html += mainComps.map(c => componentNames[c.t] || c.t).join(', ');
                html += ' onto the breadboard</li>';
            }

            // Step 3: Add resistors and capacitors
            const passives = circuit.comps.filter(c => ['r','c'].includes(c.t));
            if (passives.length > 0) {
                html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Passive Components:</strong> Place ';
                const rCount = passives.filter(c => c.t === 'r').length;
                const cCount = passives.filter(c => c.t === 'c').length;
                const parts = [];
                if (rCount) parts.push(`${rCount} resistor${rCount>1?'s':''}`);
                if (cCount) parts.push(`${cCount} capacitor${cCount>1?'s':''}`);
                html += parts.join(' and ');
                html += ' as shown in the diagram</li>';
            }

            // Step 4: Connect output devices
            const outputs = circuit.comps.filter(c => ['led','buzz','spk','servo','motor','oled'].includes(c.t));
            if (outputs.length > 0) {
                html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Output Devices:</strong> Connect ';
                html += outputs.map(c => componentNames[c.t] || c.t).join(', ');
                html += ' to their designated pins</li>';
            }

            // Step 5: Wire power connections
            html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Power Wiring:</strong> Connect red wires for positive (+) power connections</li>';

            // Step 6: Wire ground connections
            html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Ground Wiring:</strong> Connect black wires for ground (-) connections</li>';

            // Step 7: Wire signal connections
            const signalWires = circuit.wires.filter(w => w[4] === 'signal');
            if (signalWires.length > 0) {
                html += `<li style="margin-bottom: 8px; color: #ddd;"><strong>Signal Wiring:</strong> Connect ${signalWires.length} blue wire${signalWires.length>1?'s':''} for signal paths</li>`;
            }

            // Step 8: Double-check
            html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Verification:</strong> Double-check all connections match the diagram</li>';

            // Step 9: Power on
            html += '<li style="margin-bottom: 8px; color: #ddd;"><strong>Power On:</strong> Connect power and test the circuit!</li>';

            html += '</ol>';

            document.getElementById('instructionsList').innerHTML = html;
        }

        function drawCircuit(circuit) {
            const canvas = document.getElementById('circuitCanvas');
            const wireLayer = document.getElementById('wireLayer');

            canvas.querySelectorAll('.component').forEach(c => c.remove());
            wireLayer.innerHTML = '';
            components = {};

            // Draw components
            circuit.comps.forEach(comp => {
                const div = document.createElement('div');
                div.className = 'component';
                div.dataset.id = comp.id;
                div.dataset.type = comp.t;
                div.style.left = comp.x + 'px';
                div.style.top = comp.y + 'px';
                div.style.cursor = 'move';
                div.innerHTML = compHTML[comp.t] ? compHTML[comp.t](comp.v) : `<div class="ic-body">${comp.t}</div>`;

                // Add drag handlers
                div.addEventListener('mousedown', startDrag);

                canvas.appendChild(div);
                components[comp.id] = { element: div, ...comp };
            });

            // Draw wires after components render
            setTimeout(() => {
                circuit.wires.forEach(wire => {
                    const [from, fromPort, to, toPort, type] = wire;
                    drawWire(from, fromPort, to, toPort, type);
                });
            }, 100);
        }

        function drawWire(fromId, fromPort, toId, toPort, type) {
            const fromComp = components[fromId];
            const toComp = components[toId];
            if (!fromComp || !toComp) return;

            const fromPos = getConnPoint(fromComp, fromPort);
            const toPos = getConnPoint(toComp, toPort);

            const svg = document.getElementById('wireLayer');
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');

            const midX = (fromPos.x + toPos.x) / 2;
            const d = `M ${fromPos.x} ${fromPos.y} Q ${midX} ${fromPos.y}, ${midX} ${(fromPos.y + toPos.y) / 2} T ${toPos.x} ${toPos.y}`;

            path.setAttribute('d', d);
            path.setAttribute('class', `wire ${type}`);
            svg.appendChild(path);

            // Connection points
            [fromPos, toPos].forEach(pos => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', pos.x);
                circle.setAttribute('cy', pos.y);
                circle.setAttribute('r', '5');
                circle.setAttribute('class', 'connection-point');
                svg.appendChild(circle);
            });
        }

        function getConnPoint(comp, port) {
            const rect = comp.element.getBoundingClientRect();
            const canvas = document.getElementById('circuitCanvas').getBoundingClientRect();
            const relX = rect.left - canvas.left;
            const relY = rect.top - canvas.top;

            const points = connPoints[comp.t] || {};
            const point = points[port] || {dx:0.5, dy:0.5};

            return {
                x: relX + rect.width * point.dx,
                y: relY + rect.height * point.dy
            };
        }

        function startDrag(e) {
            e.preventDefault();
            draggedComponent = e.currentTarget;
            const rect = draggedComponent.getBoundingClientRect();
            const canvas = document.getElementById('circuitCanvas').getBoundingClientRect();

            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;

            draggedComponent.style.zIndex = '100';
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function drag(e) {
            if (!draggedComponent) return;

            const canvas = document.getElementById('circuitCanvas').getBoundingClientRect();
            const canvasView = document.querySelector('.canvas-view');

            let newX = e.clientX - canvas.left - dragOffset.x + canvasView.scrollLeft;
            let newY = e.clientY - canvas.top - dragOffset.y + canvasView.scrollTop;

            draggedComponent.style.left = newX + 'px';
            draggedComponent.style.top = newY + 'px';

            // Update component position in components object
            const compId = draggedComponent.dataset.id;
            if (components[compId]) {
                components[compId].x = newX;
                components[compId].y = newY;
            }

            // Redraw wires
            redrawWires();
        }

        function stopDrag(e) {
            if (draggedComponent) {
                draggedComponent.style.zIndex = '10';
                draggedComponent = null;
            }
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }

        function redrawWires() {
            const wireLayer = document.getElementById('wireLayer');
            const currentCircuit = circuits[currentCourse];
            if (!currentCircuit || !currentCircuit[currentExpIdx]) return;

            // Clear existing wires
            wireLayer.innerHTML = '';

            // Redraw all wires
            currentCircuit[currentExpIdx].wires.forEach(wire => {
                const [from, fromPort, to, toPort, type] = wire;
                drawWire(from, fromPort, to, toPort, type);
            });
        }

        function setupEventListeners() {
            document.querySelectorAll('.course-tab').forEach(tab => {
                tab.onclick = () => {
                    document.querySelectorAll('.course-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentCourse = parseInt(tab.dataset.course);
                    renderExperiments(currentCourse);
                };
            });

            document.getElementById('searchBox').oninput = (e) => {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('.experiment-card').forEach(card => {
                    const name = card.querySelector('.exp-name').textContent.toLowerCase();
                    card.style.display = name.includes(query) ? 'block' : 'none';
                });
            };
        }

        function simulateCircuit() {
            document.querySelectorAll('.led-body').forEach(led => led.classList.add('on'));
            setTimeout(() => {
                document.querySelectorAll('.led-body').forEach(led => led.classList.remove('on'));
            }, 3000);
            showNotif('‚úì Circuit simulated!');
        }

        function clearCircuit() {
            document.querySelectorAll('.component').forEach(c => c.remove());
            document.getElementById('wireLayer').innerHTML = '';
        }

        function zoomIn() {
            zoom = Math.min(zoom * 1.2, 2);
            document.getElementById('circuitCanvas').style.transform = `scale(${zoom})`;
        }

        function zoomOut() {
            zoom = Math.max(zoom / 1.2, 0.5);
            document.getElementById('circuitCanvas').style.transform = `scale(${zoom})`;
        }

        function showNotif(msg) {
            const notif = document.createElement('div');
            notif.style.cssText = 'position:fixed;top:90px;right:20px;background:linear-gradient(135deg,#2ecc71,#27ae60);color:white;padding:15px 25px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.3);z-index:2000;font-weight:bold';
            notif.textContent = msg;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 2000);
        }
    </script>
</body>
</html>