<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebVR Scene with Roads and Cars</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <style>
        body { margin: 0; }
        #vr-container { height: 100vh; }
        a-scene { height: 100vh; }
    </style>
</head>
<body>
    <div id="vr-container">
        <a-scene>
            <a-sky color="#000000"></a-sky>
            <a-box position="0 -0.5 0" rotation="-90 0 0" depth="1000" height="1" width="1000" color="#808080"></a-box>

            <script>
                const numCurves = 6;
                const curves = [];
                const roadLength = 10;
                const curveHeight = 2;

                // Create sinusoidal curves for roads
                for (let i = 0; i < numCurves; i++) {
                    const yPos = (i - numCurves / 2) * 2; // Space roads vertically
                    const curve = document.createElement('a-entity');
                    curve.setAttribute('line', {
                        path: defineSinusoidalCurve(roadLength, yPos, curveHeight),
                        color: '#FFFF00', // Yellow color for roads
                        linewidth: 2
                    });
                    document.querySelector('a-scene').appendChild(curve);
                    curves.push(curve);
                }

                // Function to define sinusoidal curve path
                function defineSinusoidalCurve(length, yOffset, height) {
                    const path = [];
                    for (let x = 0; x <= length; x += 0.1) {
                        const y = yOffset + height * Math.sin(x * 2 * Math.PI / length); // Sinusoidal function
                        path.push({ x: x - (length / 2), y: y, z: 0 });
                    }
                    return path;
                }

                // Function to create a car entity
                function createCar(color, pathIndex) {
                    const car = document.createElement('a-box');
                    car.setAttribute('color', color);
                    car.setAttribute('depth', '0.5');
                    car.setAttribute('height', '0.5');
                    car.setAttribute('width', '1');
                    car.setAttribute('animation', {
                        property: 'position',
                        to: defineCarPath(pathIndex),
                        dir: 'alternate',
                        loop: true,
                        dur: 3000
                    });
                    document.querySelector('a-scene').appendChild(car);
                    return car;
                }

                // Function to define car path
                function defineCarPath(pathIndex) {
                    const totalSteps = roadLength * 10;
                    const path = [];
                    for (let t = 0; t <= totalSteps; t++) {
                        const x = t / 10 - (roadLength / 2);
                        const y = (pathIndex - numCurves / 2) * 2 + Math.sin(t / 10 * 2 * Math.PI / roadLength);
                        path.push({ x: x, y: y, z: 0 });
                    }
                    return path[totalSteps];
                }

                // Randomly generate cars every second
                setInterval(() => {
                    const randomRoadIndex = Math.floor(Math.random() * numCurves);
                    const carColor = '#' + Math.floor(Math.random() * 16777215).toString(16);
                    createCar(carColor, randomRoadIndex);
                }, 1000);
            </script>
        </a-scene>
    </div>
</body>
</html>
