/* Core game logic for Sequence Difference Puzzle Game */

// Game State Variables
let sequenceA = [];
let sequenceB = [];
let currentIndex = 0;
let gameActive = false;

// Utility Functions
function parseSequence(input) {
    return input.split(',').map(str => parseInt(str.trim())).filter(n => !isNaN(n));
}

function generateSequence(length = 4, difficulty = "easy") {
    const seq = [];
    for(let i=0; i<length; i++) {
        let num;
        switch(difficulty) {
            case "easy":
                num = Math.floor(Math.random() * 10);
                break;
            case "medium":
                num = Math.floor(Math.random() * 50) - 25;
                break;
            case "hard":
                num = Math.floor(Math.random() * 100) - 50;
                break;
            default:
                num = Math.floor(Math.random() * 10);
        }
        seq.push(num);
    }
    return seq;
}

// Difference Calculation
function computeDifferences(seqA, seqB) {
    const length = Math.min(seqA.length, seqB.length);
    const differences = [];
    for(let i=0; i<length; i++) {
        differences.push(seqA[i] - seqB[i]);
}
    return differences;
}

// Game Initialization
function startGame() {
    const inputA = document.getElementById('sequenceA').value;
    const inputB = document.getElementById('sequenceB').value;
    sequenceA = parseSequence(inputA);
    sequenceB = parseSequence(inputB);
    if(sequenceA.length === 0 || sequenceB.length === 0) {
        alert('Please input valid sequences.');
        return;
    }
    currentIndex = 0;
    gameActive = true;
    document.getElementById('comparisonOutput').innerText = '';
    document.getElementById('nextBtn').disabled = false;
    document.getElementById('resetBtn').disabled = false;
}

// Next Step
function nextStep() {
    if(!gameActive) return;
    if(currentIndex >= Math.min(sequenceA.length, sequenceB.length)) {
        document.getElementById('comparisonOutput').innerText = 'Comparison complete!';
        return;
    }
    const diff = sequenceA[currentIndex] - sequenceB[currentIndex];
    document.getElementById('comparisonOutput').innerText = 
        `Index ${currentIndex + 1}: ${sequenceA[currentIndex]} - ${sequenceB[currentIndex]} = ${diff}`;
    currentIndex++;
}

// Reset
function resetGame() {
    sequenceA = [];
    sequenceB = [];
    currentIndex = 0;
    gameActive = false;
    document.getElementById('comparisonOutput').innerText = 'Input sequences and press "Start" to compare.';
    document.getElementById('nextBtn').disabled = true;
    document.getElementById('resetBtn').disabled = true;
}

// Event Listeners
document.getElementById('startBtn').addEventListener('click', startGame);

document.getElementById('nextBtn').addEventListener('click', nextStep);

document.getElementById('resetBtn').addEventListener('click', resetGame);

// Generate Random Sequences
document.getElementById('generateA').addEventListener('click', () => {
    const seq = generateSequence(4, 'easy');
    document.getElementById('sequenceA').value = seq.join(', ');
});

document.getElementById('generateB').addEventListener('click', () => {
    const seq = generateSequence(4, 'easy');
    document.getElementById('sequenceB').value = seq.join(', ');
});