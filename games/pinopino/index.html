<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Piano</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f0f0f0;
            margin: 0;
            padding: 20px;
            font-family: sans-serif;
        }
        .piano {
            display: flex;
            position: relative;
        }
        .key {
            width: 30px;
            height: 120px;
            margin: 0 2px;
            background: white;
            border: 1px solid #ccc;
            position: relative;
            cursor: pointer;
        }
        .key.black {
            width: 20px;
            height: 80px;
            background: black;
            position: absolute;
            left: 20px;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div class="piano" id="piano"></div>
    <script>
        const notes = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function createPiano(appendTo) {
            const piano = document.createElement('div');
            piano.classList.add('piano');
            
            for (let i = 0; i < 88; i++) {
                const key = document.createElement('div');
                key.classList.add('key');
                
                const noteIndex = i % 12;
                const note = notes[noteIndex];
                const isSharp = note.includes('#');

                if (isSharp) {
                    key.classList.add('black');
                    key.style.left = `${(i % 7) * 32 + 20}px`;
                } else {
                    key.addEventListener('click', () => playSound(note));
                }
                
                key.style.zIndex = isSharp ? '1' : '0';
                piano.appendChild(key);
                if (!isSharp) {
                    const whiteKeyOffset = (i % 7) * 32; // Grouping into octaves for offsetting
                    key.style.left = `${whiteKeyOffset}px`;
                }
            }
            
            appendTo.appendChild(piano);
        }

        function playSound(note) {
            const oscillator = audioContext.createOscillator();
            oscillator.type = 'sine';
            const frequency = noteToFrequency(note);
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.connect(audioContext.destination);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.2);
            createPiano(document.body); // Spawn a new piano
        }

        function noteToFrequency(note) {
            const noteFreqMap = {
                "C": 261.63, "C#": 277.18, "D": 293.66, "D#": 311.13, "E": 329.63,
                "F": 349.23, "F#": 369.99, "G": 392.00, "G#": 415.30, "A": 440.00,
                "A#": 466.16, "B": 493.88
            };
            return noteFreqMap[note] || 440; // Default to A4
        }

        createPiano(document.body); // Create the initial piano
    </script>
</body>
</html>
