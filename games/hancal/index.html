<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Mattf's Calendar</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap');
  body {
    font-family: 'Montserrat', sans-serif;
    background-color: #121212;
    color: #e0e0e0;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 30px;
  }
  h1 {
    font-size: 2.5em;
    margin-bottom: 10px;
    font-weight: 600;
    background: linear-gradient(90deg, #ff416c, #ff4b2b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 10px rgba(255, 70, 92, 0.7);
  }
  .controls {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 30px;
  }
  button {
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    background-color: #1f1f1f;
    color: #e0e0e0;
    font-weight: 500;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s ease;
  }
  button:hover {
    background-color: #333;
  }
  select {
    padding: 10px 14px;
    border-radius: 8px;
    border: 1px solid #444;
    background-color: #222;
    color: #e0e0e0;
    font-size: 14px;
    font-family: 'Montserrat', sans-serif;
  }
  select:focus {
    outline: none;
    border-color: #ff4b2b;
  }
  .calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
    width: 100%;
    max-width: 950px;
  }
  .day-header {
    background: linear-gradient(135deg, #222, #333);
    padding: 12px;
    text-align: center;
    font-weight: 600;
    font-size: 14px;
    border-radius: 8px 8px 0 0;
    color: #ddd;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .cell {
    background: linear-gradient(145deg, #1f1f1f, #292929);
    padding: 15px;
    min-height: 70px;
    border-radius: 8px;
    border: 2px solid transparent; 
    box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    cursor: pointer;
    transition: border-color 0.2s ease;
  }
  .cell.border-selected {
    border-color: #ff4b2b; 
    box-shadow: 0 0 15px rgba(255, 70, 92, 0.7);
  }
  .cell.disabled {
    background: #333; 
    color: #777; 
    cursor: not-allowed; 
  }
  .cell:hover:not(.disabled) {
    box-shadow: inset 0 0 12px rgba(255, 70, 92, 0.7);
  }
  .cell:hover.disabled {
    box-shadow: none; 
  }
  .date {
    font-size: 1.2em;
    font-weight: 600;
    color: #ff416c;
    margin-bottom: 8px;
  }
  .today {
    border: 2px solid #4a90e2;
  }
  @media(max-width: 600px){
    body {
      padding: 15px;
    }
    h1 {
      font-size: 2em;
    }
    .calendar {
      grid-template-columns: repeat(7, 1fr);
    }
    .cell {
      min-height: 60px;
    }
  }
</style>
</head>
<body>
<h1>Mattf's Calendar</h1>
<div class="controls">
  <button id="prevBtn">‹ Prev</button>
  <button id="nextBtn">Next ›</button>
  <select id="monthSelect"></select>
  <select id="yearSelect"></select>
</div>
<div id="calendarContainer"></div>
<script>
const calendarContainer = document.getElementById('calendarContainer');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const monthSelect = document.getElementById('monthSelect');
const yearSelect = document.getElementById('yearSelect');

const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const urlParams = new URLSearchParams(window.location.search);
const urlYear = parseInt(urlParams.get('year'));
const urlMonth = parseInt(urlParams.get('month'));
const today = new Date();

let currentYear = isNaN(urlYear) ? today.getFullYear() : urlYear;
let currentMonth = isNaN(urlMonth) ? today.getMonth() : urlMonth;

// Populate month dropdown
for(let m=0; m<12; m++) {
  const option = document.createElement('option');
  option.value = m;
  option.innerText = monthNames[m];
  if(m === currentMonth) option.selected = true;
  monthSelect.appendChild(option);
}

// Populate year dropdown from 1500 to 2100
for(let y = 2100; y >= 1500; y--) {
  const option = document.createElement('option');
  option.value = y;
  option.innerText = y;
  if(y === currentYear) option.selected = true;
  yearSelect.appendChild(option);
}

function getMondayOfMonth(year, month) {
  let date = new Date(year, month, 1);
  const day = date.getDay();
  const diff = (day === 0) ? 6 : day - 1;
  date.setDate(date.getDate() - diff);
  return date;
}

let selectedDate = null;

function generateCalendar(year, month) {
  calendarContainer.innerHTML = '';

  const header = document.createElement('div');
  header.className = 'calendar';

  for(let i=0; i<7; i++) {
    const dayHeader = document.createElement('div');
    dayHeader.className = 'day-header';
    dayHeader.innerText = 'Monday';
    header.appendChild(dayHeader);
  }
  calendarContainer.appendChild(header);

  let startDate = getMondayOfMonth(year, month);
  if (startDate.getMonth() !== month && startDate.getDate() > 7) {
    startDate = new Date(year, month, 1);
    const day = startDate.getDay();
    const diff = (day === 0) ? 6 : day - 1;
    startDate.setDate(startDate.getDate() - diff);
  }

  const totalWeeks = 6;
  let currentDate = new Date(startDate);

  for(let week=0; week<totalWeeks; week++) {
    const weekDiv = document.createElement('div');
    weekDiv.className = 'calendar';
    for(let dayIdx=0; dayIdx<7; dayIdx++) {
      const cell = document.createElement('div');
      cell.className = 'cell';

      const displayDate = new Date(currentDate);
      if (displayDate.getMonth() !== month && displayDate.getFullYear() !== year) {
        cell.classList.add('disabled'); 
        cell.innerHTML = `<div class="date">${displayDate.getDate()}</div>`;
      } else {
        if (displayDate.getMonth() !== month) {
          cell.classList.add('disabled');
        }

        cell.innerHTML = `<div class="date">${displayDate.getDate()}</div>`;
        cell.classList.remove('today', 'border-selected');

        if (
          displayDate.getFullYear() === today.getFullYear() &&
          displayDate.getMonth() === today.getMonth() &&
          displayDate.getDate() === today.getDate()
        ) {
          cell.classList.add('today');
        }

        if (selectedDate &&
            displayDate.getFullYear() === selectedDate.getFullYear() &&
            displayDate.getMonth() === selectedDate.getMonth() &&
            displayDate.getDate() === selectedDate.getDate()) {
          cell.classList.add('border-selected');
        }

        cell.onclick = () => {
          if (cell.classList.contains('disabled')) return;
          const prevSelected = document.querySelector('.cell.border-selected');
          if (prevSelected) prevSelected.classList.remove('border-selected');
          cell.classList.add('border-selected');
          selectedDate = new Date(displayDate);
          const y = displayDate.getFullYear();
          const m = displayDate.getMonth();
          const d = displayDate.getDate();
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('year', y);
          newUrl.searchParams.set('month', m);
          newUrl.searchParams.set('day', d);
          window.history.pushState({}, '', newUrl);
        };
      }

      currentDate.setDate(currentDate.getDate() + 1);
      weekDiv.appendChild(cell);
    }
    calendarContainer.appendChild(weekDiv);
  }
}

function showCalendar() {
  generateCalendar(currentYear, currentMonth);
  updateSelectors();
}

function updateSelectors() {
  monthSelect.value = currentMonth;
  yearSelect.value = currentYear;
}

prevBtn.onclick = () => {
  currentMonth--;
  if(currentMonth < 0) { currentMonth = 11; currentYear--; }
  showCalendar();
};
nextBtn.onclick = () => {
  currentMonth++;
  if(currentMonth > 11) { currentMonth = 0; currentYear++; }
  showCalendar();
};
monthSelect.onchange = () => {
  currentMonth = parseInt(monthSelect.value);
  showCalendar();
};
yearSelect.onchange = () => {
  currentYear = parseInt(yearSelect.value);
  showCalendar();
};

// Load from URL param
const urlDay = parseInt(new URLSearchParams(window.location.search).get('day'));
if (!isNaN(urlDay) && urlDay >= 1 && urlDay <= 31) {
  const urlYear = parseInt(new URLSearchParams(window.location.search).get('year'));
  const urlMonth = parseInt(new URLSearchParams(window.location.search).get('month'));
  if (!isNaN(urlYear) && !isNaN(urlMonth)) {
    currentYear = urlYear;
    currentMonth = urlMonth;
    const validDate = new Date(currentYear, currentMonth, urlDay);
    if (validDate.getFullYear() === currentYear && validDate.getMonth() === currentMonth && validDate.getDate() === urlDay) {
      selectedDate = validDate;
    }
  }
}

updateSelectors();
showCalendar();
</script>
</body>
</html>
